
/* -----------------------------------------------------------------------------------
   001 DATA COLLECTION
   ----------------------------------------------------------------------------------- */

lockPref("toolkit.aboutLogging.uploadProfileToCloud", false);
lockPref("toolkit.aboutlogging.uploadProfileUrl", "");

lockPref("toolkit.coverage.enabled", false);
lockPref("toolkit.coverage.endpoint.base", "");
lockPref("toolkit.coverage.log-level", 70);
lockPref("toolkit.coverage.opt-out", true);
lockPref("toolkit.telemetry.coverage.opt-out", true);

lockPref("breakpad.reportURL", "");
lockPref("browser.crashReports.crashPull", false);
lockPref("browser.crashReports.requestedNeverShowAgain", true);
lockPref("browser.crashReports.unsubmittedCheck.autoSubmit2", false);
lockPref("browser.crashReports.unsubmittedCheck.enabled", false);
lockPref("toolkit.crashreporter.include_context_heap", false);

lockPref("browser.safebrowsing.features.emailtracking.datacollection.update", false);
lockPref("captchadetection.actor.enabled", false);
lockPref("captchadetection.hasUnsubmittedData", false);
lockPref("captchadetection.loglevel", "Off");
lockPref("datareporting.dau.cachedUsageProfileID", "beefbeef-beef-beef-beef-beeefbeefbee");
lockPref("datareporting.dau.cachedUsageProfileGroupID", "b0bacafe-b0ba-cafe-b0ba-cafeb0bacafe");
lockPref("datareporting.healthreport.uploadEnabled", false);
lockPref("datareporting.policy.dataSubmissionEnabled", false);
lockPref("datareporting.policy.dataSubmissionPolicyBypassNotification", true);
lockPref("datareporting.policy.firstRunURL", "");
lockPref("datareporting.usage.uploadEnabled", false);
lockPref("dom.security.unexpected_system_load_telemetry_enabled", false);
lockPref("extensions.dataCollectionPermissions.enabled", false);
lockPref("extensions.telemetry.EnvironmentAddonBuilder", false);
lockPref("network.jar.record_failure_reason", false);
lockPref("network.traffic_analyzer.enabled", false);
lockPref("network.trr.confirmation_telemetry_enabled", false);
lockPref("nimbus.telemetry.targetingContextEnabled", false);
lockPref("privacy.imageInputTelemetry.enableTestMode", false);
lockPref("privacy.trackingprotection.emailtracking.data_collection.enabled", false);
lockPref("telemetry.fog.aboutGlean.debugTag", "");
lockPref("telemetry.fog.artifact_build", false);
lockPref("telemetry.fog.test.activity_limit", -1);
lockPref("telemetry.fog.test.inactivity_limit", -1);
lockPref("telemetry.fog.init_on_shutdown", false);
lockPref("telemetry.fog.test.localhost_port", 70000);
lockPref("telemetry.glean.internal.finalInactive", false);
lockPref("telemetry.glean.internal.maxPingsPerMinute", 0);
lockPref("telemetry.number_of_site_origin.min_interval", 999999999);
lockPref("toolkit.content-background-hang-monitor.disabled", true);
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.bhrPing.enabled", false);
lockPref("toolkit.telemetry.cachedClientID", "c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0");
lockPref("toolkit.telemetry.cachedProfileGroupID", "decafdec-afde-cafd-ecaf-decafdecafde");
lockPref("toolkit.telemetry.collectInterval", 999999999);
lockPref("toolkit.telemetry.dap.helper.hpke", "");
lockPref("toolkit.telemetry.dap.helper.url", "");
lockPref("toolkit.telemetry.dap.leader.hpke", "");
lockPref("toolkit.telemetry.dap.leader.url", "");
lockPref("toolkit.telemetry.dap.logLevel", "Off");
lockPref("toolkit.telemetry.dap_enabled", false);
lockPref("toolkit.telemetry.dap_task1_enabled", false);
lockPref("toolkit.telemetry.dap_task1_taskid", "");
lockPref("toolkit.telemetry.dap_visit_counting_enabled", false);
lockPref("toolkit.telemetry.dap_visit_counting_experiment_list", "[]");
lockPref("toolkit.telemetry.debugSlowSql", false);
lockPref("toolkit.telemetry.enabled", false);
lockPref("toolkit.telemetry.eventping.maximumFrequency", 999999999);
lockPref("toolkit.telemetry.eventping.minimumFrequency", 999999999);
lockPref("toolkit.telemetry.firstShutdownPing.enabled", false);
lockPref("toolkit.telemetry.healthping.enabled", false);
lockPref("toolkit.telemetry.initDelay", 999999999);
lockPref("toolkit.telemetry.log.dump", false);
lockPref("toolkit.telemetry.log.level", "Fatal");
lockPref("toolkit.telemetry.minSubsessionLength", 999999999);
lockPref("toolkit.telemetry.newProfilePing.delay", 999999999);
lockPref("toolkit.telemetry.newProfilePing.enabled", false);
lockPref("toolkit.telemetry.overrideUpdateChannel", "release");
lockPref("toolkit.telemetry.previousBuildID", "");
lockPref("toolkit.telemetry.reportingpolicy.firstRun", false);
lockPref("toolkit.telemetry.scheduler.idleTickInterval", 999999999);
lockPref("toolkit.telemetry.scheduler.tickInterval", 999999999);
lockPref("toolkit.telemetry.send.overrideOfficialCheck", false);
lockPref("toolkit.telemetry.server", "data;");
lockPref("toolkit.telemetry.server_owner", "");
lockPref("toolkit.telemetry.shutdownPingSender.backgroundtask.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabledFirstSession", false);
lockPref("toolkit.telemetry.testing.disableFuzzingDelay", false);
lockPref("toolkit.telemetry.testing.overridePreRelease", false);
lockPref("toolkit.telemetry.testing.overrideProductsCheck", false);
lockPref("toolkit.telemetry.testing.suppressPingsender", true);
lockPref("toolkit.telemetry.translations.logLevel", "Off");
lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.untrustedModulesPing.frequency", 999999999);
lockPref("toolkit.telemetry.updatePing.enabled", false);
lockPref("toolkit.telemetry.user_characteristics_ping.current_version", 0);
lockPref("toolkit.telemetry.user_characteristics_ping.last_version_sent", 0);
lockPref("toolkit.telemetry.user_characteristics_ping.logLevel", "Off");
lockPref("toolkit.telemetry.user_characteristics_ping.opt-out", true);
lockPref("toolkit.telemetry.user_characteristics_ping.send-once", false);
lockPref("toolkit.telemetry.user_characteristics_ping.uuid", "");
lockPref("urlclassifier.features.emailtracking.datacollection.allowlistTables", "");
lockPref("urlclassifier.features.emailtracking.datacollection.blocklistTables", "");

lockPref("app.normandy.run_interval_seconds", 0);
lockPref("app.shield.optoutstudies.enabled", false);
lockPref("messaging-system.rsexperimentloader.collection_id", "");
lockPref("nimbus.appId", "");
lockPref("nimbus.profileId", "");
lockPref("nimbus.profilesdatastoreservice.enabled", false);
lockPref("nimbus.profilesdatastoreservice.read.enabled", false);
lockPref("nimbus.profilesdatastoreservice.sync.enabled", false);

lockPref("about.glean.redesign.enabled", false);

lockPref("dom.origin-trials.enabled", false);

lockPref("app.distributor", "");
lockPref("app.distributor.channel", "");
lockPref("mozilla.partner.id", "");

/* -----------------------------------------------------------------------------------
   002 MOZILLA CRAP
   ----------------------------------------------------------------------------------- */

// Clear unnecessary/undesired Mozilla URLs
lockPref("app.feedback.baseURL", "");
lockPref("datareporting.healthreport.infoURL", "");
lockPref("extensions.recommendations.privacyPolicyUrl", "");
lockPref("toolkit.datacollection.infoURL", "");

// Disable add-on/feature recommendations
lockPref("browser.discovery.enabled", false);
lockPref("browser.translations.mostRecentTargetLanguages", "en-US");
lockPref("browser.translations.panelShown", true);
lockPref("extensions.getAddons.browseAddons", "");
lockPref("extensions.getAddons.discovery.api_url", "data;");
lockPref("extensions.getAddons.showPane", false);
lockPref("extensions.htmlaboutaddons.recommendations.enabled", false);
lockPref("extensions.recommendations.hideNotice", true);
lockPref("extensions.recommendations.themeRecommendationUrl", "");
lockPref("extensions.ui.lastCategory", "addons://list/extension");
lockPref("extensions.webservice.discoverURL", "");

// Disable DoH Rollout/heuristics/steering
lockPref("doh-rollout._testing", true);
lockPref("doh-rollout.disable-heuristics", true);
lockPref("doh-rollout.doneFirstRun", true);
lockPref("doh-rollout.doorhanger-decision", "UIDisabled");
lockPref("doh-rollout.enabled", false);
lockPref("doh-rollout.mode", 5);
lockPref("doh-rollout.provider-steering.enabled", false);
lockPref("doh-rollout.provider-steering.provider-list", "");
lockPref("doh-rollout.self-enabled", false);
lockPref("doh-rollout.skipHeuristicsCheck", true);
lockPref("doh-rollout.trr-selection.enabled", false);
lockPref("doh-rollout.trr-selection.provider-list", "");
lockPref("doh-rollout.uri", "");
lockPref("network.android_doh.autoselect_enabled", false);

// Disable DoH performance measurements
lockPref("doh-rollout.trrRace.canonicalDomain", "");
lockPref("doh-rollout.trrRace.complete", true);
lockPref("doh-rollout.trrRace.enabled", false);
lockPref("doh-rollout.trrRace.popularDomains", "");
lockPref("doh-rollout.trrRace.randomSubdomainCount", 0);

// Disable 'Essential Domains Fallback'
lockPref("network.essential_domains_fallback", false);

// Disable Fakespot
lockPref("toolkit.shopping.ohttpConfigURL", "");
lockPref("toolkit.shopping.ohttpRelayURL", "");

// Disable fetching Firefox Relay's "allowlist" (list of sites known to support Relay)
lockPref("signon.firefoxRelay.allowListRemoteSettingsCollection", "");

// Disable fetching Password Manager rules remotely by default
lockPref("signon.recipes.remoteRecipes.enabled", false);

// Disable Firefox Messaging System targeting information background updates
lockPref("app.update.background.messaging.targeting.snapshot.intervalSec", -1); 

// Disable Firefox Relay by default
lockPref("signon.firefoxRelay.feature", "disabled");

// Disable "Interest-based Content Relevance Ranking and Personalization"
lockPref("toolkit.contentRelevancy.enabled", false);
lockPref("toolkit.contentRelevancy.ingestEnabled", false);
lockPref("toolkit.contentRelevancy.log", false);

// Disable Mozilla nags/promotions
lockPref("browser.promo.cookiebanners.enabled", false);
lockPref("browser.promo.focus.enabled", false);
lockPref("browser.promo.pin.enabled", false);
lockPref("browser.send_to_device_locales", "");
lockPref("browser.vpn_promo.enabled", false);
lockPref("privacy.trackingprotection.allow_list.hasUserInteractedWithETPSettings", true);

// Disable "Privacy-Preserving Attribution"
lockPref("dom.origin-trials.private-attribution.state", 2);
lockPref("dom.private-attribution.submission.enabled", false);

// Disable Remote Permissions
lockPref("permissions.manager.remote.enabled", false);

// Disable Remote Settings 'Preview' Buckets
lockPref("services.settings.preview_enabled", false);  

// Disable the Web Compatibility Reporter
lockPref("extensions.webcompat-reporter.enabled", false);

// Opt out of add-on metadata updates
lockPref("extensions.getAddons.cache.enabled", false);

// Remove special privileges from Mozilla domains
lockPref("browser.tabs.remote.separatePrivilegedMozillaWebContentProcess", false);
lockPref("browser.tabs.remote.separatedMozillaDomains", "");
lockPref("dom.ipc.processCount.privilegedmozilla", 0);
lockPref("extensions.webextensions.restrictedDomains", "");
lockPref("permissions.manager.defaultsUrl", "");
lockPref("svg.context-properties.content.allowed-domains", "");

// Remove tracking parameters from Mozilla URLs + prevent exposing locale & unnecessary information
lockPref("browser.backup.template.fallback-download.aurora", "https://www.mozilla.org/firefox/channel/desktop/#developer");
lockPref("browser.backup.template.fallback-download.beta", "https://www.mozilla.org/firefox/channel/desktop/#beta");
lockPref("browser.backup.template.fallback-download.esr", "https://www.mozilla.org/firefox/enterprise/#download");
lockPref("browser.backup.template.fallback-download.nightly", "https://www.mozilla.org/firefox/channel/desktop/#nightly");
lockPref("browser.backup.template.fallback-download.release", "https://www.mozilla.org/firefox/download/thanks/?s=direct");
lockPref("extensions.abuseReport.amoFormURL", "https://addons.mozilla.org/feedback/addon/%addonID%/");
lockPref("extensions.blocklist.addonItemURL", "https://addons.mozilla.org/blocked-addon/%addonID%/%addonVersion%/");
lockPref("signon.firefoxRelay.learn_more_url", "https://support.mozilla.org/kb/relay-integration#w_frequently-asked-questions");
lockPref("signon.firefoxRelay.manage_url", "https://relay.firefox.com/accounts/profile/");
lockPref("signon.firefoxRelay.privacy_policy_url", "https://www.mozilla.org/privacy/subscription-services/");
lockPref("signon.firefoxRelay.terms_of_service_url", "https://www.mozilla.org/about/legal/terms/subscription-services/");

// Skip Mozilla's `Privacy Notice` and `Terms of Use`
lockPref("datareporting.policy.dataSubmissionPolicyAcceptedVersion", 999);
lockPref("datareporting.policy.dataSubmissionPolicyNotifiedTime", "32503679999000");
lockPref("termsofuse.acceptedDate", "32503679999000");
lockPref("termsofuse.acceptedVersion", 999);
lockPref("termsofuse.bypassNotification", true);

/* -----------------------------------------------------------------------------------
   003 TRACKING PROTECTION
   ----------------------------------------------------------------------------------- */

// Disable exceptions for minor issues by default
lockPref("privacy.trackingprotection.allow_list.convenience.enabled", false);

// Enable ETP Strict
lockPref("browser.contentblocking.category", "strict"); 

// Block known consent managers (CMPs)
lockPref("privacy.trackingprotection.consentmanager.annotate_channels", true);
lockPref("privacy.trackingprotection.consentmanager.skip.enabled", false);
lockPref("privacy.trackingprotection.consentmanager.skip.pbmode.enabled", false);

// Block known cryptominers
lockPref("privacy.trackingprotection.cryptomining.enabled", true);

// Block known email trackers
lockPref("privacy.trackingprotection.emailtracking.enabled", true);
lockPref("privacy.trackingprotection.emailtracking.pbmode.enabled", true);

// Block known fingerprinters
lockPref("privacy.trackingprotection.antifraud.annotate_channels", true);
lockPref("privacy.trackingprotection.antifraud.skip.enabled", false);
lockPref("privacy.trackingprotection.antifraud.skip.pbmode.enabled", false);
lockPref("privacy.trackingprotection.fingerprinting.enabled", true);

// Block known social trackers
lockPref("privacy.trackingprotection.socialtracking.enabled", true);

// Block known trackers
lockPref("privacy.trackingprotection.annotate_channels", true);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode.enabled", true);

// Block known trackers using the `strict` (Level 2) list
lockPref("privacy.annotate_channels.strict_list.enabled", true);
lockPref("privacy.annotate_channels.strict_list.pbmode.enabled", true);

// Block known tracking cookies
lockPref("network.cookie.cookieBehavior.trackerCookieBlocking", true);
lockPref("privacy.socialtracking.block_cookies.enabled", true);

// Enable Bounce Tracking Protection
lockPref("privacy.bounceTrackingProtection.mode", 1);
lockPref("privacy.bounceTrackingProtection.requireStatefulBounces", false);

// Enable Query Parameter Stripping
lockPref("privacy.query_stripping.enabled", true);
lockPref("privacy.query_stripping.enabled.pbmode", true);
lockPref("privacy.query_stripping.redirect", true);

// Enable SmartBlock & UA overrides/injections
lockPref("extensions.webcompat.enable_shims", true);
lockPref("extensions.webcompat.perform_injections", true);
lockPref("extensions.webcompat.perform_ua_overrides", true);
lockPref("extensions.webcompat.smartblockEmbeds.enabled", true);

// Enable State Partitioning
lockPref("network.fetch.cache_partition_cross_origin", true);
lockPref("privacy.partition.always_partition_third_party_non_cookie_storage", true);
lockPref("privacy.partition.always_partition_third_party_non_cookie_storage.exempt_sessionstorage", false);
lockPref("privacy.partition.bloburl_per_partition_key", true);
lockPref("privacy.partition.network_state", true);
lockPref("privacy.partition.network_state.ocsp_cache", true);
lockPref("privacy.partition.network_state.ocsp_cache.pbmode", true);
lockPref("privacy.partition.serviceWorkers", true);

// Enable Suspected Fingerprinters Protection (FPP)
lockPref("privacy.fingerprintingProtection", true);
lockPref("privacy.fingerprintingProtection.pbmode", true);
lockPref("privacy.reduceTimerPrecision", true);

// Enable TCP/dFPI
lockPref("network.cookie.cookieBehavior", 5);
lockPref("network.cookie.cookieBehavior.optInPartitioning", true);
lockPref("network.cookie.cookieBehavior.optInPartitioning.pbmode", true);
lockPref("network.cookie.cookieBehavior.pbmode", 5);

// Ignore less restricted referer policies (than the default)
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.pbmode", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.pbmode.top_navigation", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.top_navigation", true);

// Exceptions required to avoid major breakage by default
lockPref("privacy.trackingprotection.allow_list.baseline.enabled", false);
lockPref("privacy.trackingprotection.allow_list.hasMigratedCategoryPrefs", false);

// Lower the network priority of known trackers (if not blocked for whatever reason...)
lockPref("privacy.trackingprotection.lower_network_priority", true);

/* -----------------------------------------------------------------------------------
   004 FINGERPRINTING PROTECTION
   ----------------------------------------------------------------------------------- */

// Disable the ability to switch locales without requiring a restart
lockPref("intl.multilingual.liveReload", false);
lockPref("intl.multilingual.liveReloadBidirectional", false);

// Disable failIfMajorPerformanceCaveat in WebGL contexts
lockPref("webgl.disable-fail-if-major-performance-caveat", true);

// Disable VP9 Benchmark
lockPref("media.benchmark.vp9.threshold", 0);

// Do not use the theme's toolbar color scheme for in-content pages by default
lockPref("browser.theme.unified-color-scheme", false);

// Enable canvas randomization for the browser chrome
lockPref("privacy.resistFingerprinting.randomization.canvas.disable_for_chrome", false);

// Enable fdlibm for Math.sin, Math.cos, and Math.tan
lockPref("javascript.options.use_fdlibm_for_sin_cos_tan", true);

// If FPP/RFP is disabled, limit font visibility to base system fonts + fonts from
lockPref("layout.css.font-visibility", 2);

// Prevent enumeration of media devices
lockPref("media.devices.enumerate.legacy.enabled", false);

// Prevent exposing WebGL Renderer Info
lockPref("webgl.enable-renderer-query", false);
lockPref("webgl.override-unmasked-renderer", "Mozilla");
lockPref("webgl.override-unmasked-vendor", "Mozilla");
lockPref("webgl.sanitize-unmasked-renderer", false);

// Prevent pre-allocating content processes
lockPref("dom.ipc.processPrelaunch.enabled", false);
lockPref("dom.ipc.processPrelaunch.fission.number", 0);

// Prevent using system accent colors
lockPref("widget.non-native-theme.use-theme-accent", false);

// Prevent using system colors
lockPref("browser.display.use_system_colors", false);
lockPref("ui.use_standins_for_native_colors", true);

// Prompt to spoof locale to en-US
lockPref("privacy.spoof_english", 0);

// Reset the fingerprinting randomization key daily (in addition to per-session/when the browser restarts)
lockPref("privacy.resistFingerprinting.randomization.daily_reset.enabled", true);
lockPref("privacy.resistFingerprinting.randomization.daily_reset.private.enabled", true);

// Round window sizes
lockPref("browser.startup.blankWindow", false);
lockPref("privacy.window.maxInnerHeight", 900);
lockPref("privacy.window.maxInnerWidth", 1600);

// Set a fixed temporary storage limit
lockPref("dom.quotaManager.temporaryStorage.fixedLimit", 52428800);

// Set target video resolution to 1080p
lockPref("privacy.resistFingerprinting.target_video_res", 1080);

// Set zoom levels on a per-site basis
lockPref("browser.zoom.siteSpecific", true);

/* -----------------------------------------------------------------------------------
   005 DISK AVOIDANCE
   ----------------------------------------------------------------------------------- */

// Allow permission manager to write to disk
lockPref("permissions.memory_only", false); 

// Allow users to automatically delete files downloaded in Private Browsing
lockPref("browser.download.enableDeletePrivate", true);

// Disable back/forward cache (bfcache)
lockPref("browser.sessionhistory.max_total_viewers", 0);
lockPref("fission.bfcacheInParent", false);

// Disable collection/generation of background thumbnails
lockPref("browser.pagethumbnails.capturing_disabled", true);

// Disable collection/generation of wireframes
lockPref("browser.history.collectWireframes", false);

// Disable coloring visited links
lockPref("layout.css.visited_links_enabled", false);

// Disable disk cache
lockPref("browser.cache.disk.enable", false);
lockPref("browser.cache.disk_cache_ssl", true);

// Disable favicons in shortcuts 
lockPref("browser.shell.shortcutFavicons", false); 

lockPref("browser.contentblocking.database.enabled", false);

// Disable Search & Form History
lockPref("browser.formfill.enable", false);

// Disable WebRTC history
lockPref("media.aboutwebrtc.hist.enabled", false);

// Disable window state restoration
lockPref("browser.restoreWindowState.disabled", true);

// Increase the interval between between Session Store save operations
lockPref("browser.sessionstore.interval", 600000); // 10 minutes

// Prevent storing unnecessary extra session data
lockPref("browser.sessionstore.privacy_level", 2);

// Prevent writing media cache (ex. for video streaming) to disk in private windows
lockPref("browser.privatebrowsing.forceMediaMemoryCache", true);

// Remove cached files from browser windows opened with external applications
lockPref("browser.download.start_downloads_in_tmp_dir", true);
lockPref("browser.helperApps.deleteTempFileOnExit", true);

/* -----------------------------------------------------------------------------------
   006 DOWNLOADS
   ----------------------------------------------------------------------------------- */

// Block insecure downloads
lockPref("dom.block_download_insecure", true);

// Disable extra download logging by default
lockPref("browser.download.loglevel", "Error");

// Notify when downloading files
lockPref("browser.download.alwaysOpenPanel", true);

// Prevent adding downloads to "recent documents"...
lockPref("browser.download.manager.addToRecentDocs", false);

// Prompt before downloading files
lockPref("browser.download.always_ask_before_handling_new_types", true);
lockPref("browser.download.useDownloadDir", false);

/* -----------------------------------------------------------------------------------
   007 HTTP(S)
   ----------------------------------------------------------------------------------- */

// Allow users to bypass invalid certificate errors by default
lockPref("security.certerror.hideAddException", false); 

// Always preload intermediates
lockPref("security.remote_settings.intermediates.enabled", true);

// Always warn on insecure webpages
lockPref("security.insecure_connection_text.enabled", true);
lockPref("security.insecure_connection_text.pbmode.enabled", true);
lockPref("security.ssl.treat_unsafe_negotiation_as_broken", true);

// Always warn when submitting a form from HTTP to HTTPS, even on local IP addresses
lockPref("security.insecure_field_warning.ignore_local_ip_address", false);
lockPref("security.warn_submit_secure_to_insecure", true);

// Disable the automatic import of OS client authentication certificates
lockPref("security.osclientcerts.autoload", false);

// Disable downgrades to insecure TLS 1.0/1.1
lockPref("security.tls.insecure_fallback_hosts", "");
lockPref("security.tls.version.enable-deprecated", false);

// Disable insecure ciphers (Like Chromium & Tor Browser)
lockPref("security.ssl3.dhe_rsa_aes_128_sha", false);
lockPref("security.ssl3.dhe_rsa_aes_256_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_128_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_256_sha", false);

// Disable Parental Controls
lockPref("network.parental_controls_cached_state", false);

// Disable sending background HTTP requests to websites that do not respond quickly to check if they support HTTPS
lockPref("dom.security.https_only_mode_send_http_background_request", false);

// Disable third-party/OS-level root certificates
lockPref("security.certerrors.mitm.auto_enable_enterprise_roots", false); 
lockPref("security.enterprise_roots.enabled", false);

// Ensure HTTP/3 isn't disabled when/if third-party/OS-level root certificates are found
lockPref("network.http.http3.disable_when_third_party_roots_found", false);

// Disable TLS 1.3 0-RTT
lockPref("network.http.http3.enable_0rtt", false);
lockPref("security.tls.enable_0rtt_data", false);

// Enable (+ enforce) Certificate Transparency
lockPref("security.pki.certificate_transparency.disable_for_hosts", "");
lockPref("security.pki.certificate_transparency.disable_for_spki_hashes", "");
lockPref("security.pki.certificate_transparency.mode", 2);

// Enable CRLite revocation checks & prioritize over OCSP
lockPref("security.pki.crlite_mode", 2);
lockPref("security.remote_settings.crlite_filters.enabled", true);

// Enable Delegated Credentials
lockPref("security.tls.enable_delegated_credentials", true);

// Enable MITM Detection
lockPref("security.certerrors.mitm.priming.enabled", true);
lockPref("security.certerrors.mitm.priming.endpoint", "https://mitmdetection.services.mozilla.com/");

// Enable OCSP stapling
lockPref("security.ssl.enable_ocsp_must_staple", true);
lockPref("security.ssl.enable_ocsp_stapling", true);

// Enable Post Quantum Key Agreement (Kyber)
lockPref("media.webrtc.enable_pq_dtls", true);
lockPref("network.http.http3.enable_kyber", true);
lockPref("security.tls.client_hello.send_p256_keyshare", true);
lockPref("security.tls.enable_kyber", true);

// Enable prompts for unsafe HTTP redirects
lockPref("network.http.prompt-temp-redirect", true);

// Enforce Strict Certificate Pinning
lockPref("security.cert_pinning.enforcement_level", 2);

// Enforce TLS 1.3 downgrade protection
lockPref("security.tls.hello_downgrade_check", true);

// Enforce using HTTPS as much as possible
lockPref("dom.securecontext.allowlist", "");
lockPref("dom.security.https_first", true);
lockPref("dom.security.https_first_for_custom_ports", true);
lockPref("dom.security.https_first_for_local_addresses", true);
lockPref("dom.security.https_first_for_unknown_suffixes", true);
lockPref("dom.security.https_first_pbm", true);
lockPref("dom.security.https_first_schemeless", true);
lockPref("dom.security.https_only_mode", true);
lockPref("dom.security.https_only_mode.upgrade_local", true);
lockPref("dom.security.https_only_mode_pbm", true);
lockPref("security.mixed_content.block_active_content", true);
lockPref("security.mixed_content.block_display_content", false);
lockPref("security.mixed_content.block_object_subrequest", true);
lockPref("security.mixed_content.upgrade_display_content", true);
lockPref("security.mixed_content.upgrade_display_content.audio", true);
lockPref("security.mixed_content.upgrade_display_content.image", true);
lockPref("security.mixed_content.upgrade_display_content.video", true);

// Ensure we use the HSTS preload list
lockPref("network.stricttransportsecurity.preloadlist", true);

// If HTTPS-Only Mode is disabled in favor of HTTPS-First, prevent automatically exempting domains (to ensure we always try HTTPS first...)
lockPref("dom.security.https_first_add_exception_on_failure", false);

// Only allow certificate error exceptions per-session
lockPref("security.certerrors.permanentOverride", false);

// Only load secure websockets from HTTPS pages
lockPref("network.websocket.allowInsecureFromHTTPS", false);

// Require safe renegotiations
lockPref("security.ssl.require_safe_negotiation", true);

// Show detailed information on insecure warning pages
lockPref("browser.xul.error_pages.expert_bad_cert", true);

// Show suggestions when an HTTPS page can not be found 
lockPref("dom.security.https_only_mode_error_page_user_suggestions", true);

/* -----------------------------------------------------------------------------------
   008 IMPLICIT CONNECTIONS
   ----------------------------------------------------------------------------------- */

// Disable Early Hints (Like Cromite)
lockPref("network.early-hints.enabled", false);
lockPref("network.early-hints.over-http-v1-1.enabled", false);
lockPref("network.early-hints.preconnect.enabled", false);
lockPref("network.early-hints.preconnect.max_connections", 0);

// Disable Network Prefetching
lockPref("dom.prefetch_dns_for_anchor_http_document", false);
lockPref("dom.prefetch_dns_for_anchor_https_document", false);
lockPref("network.dns.disablePrefetch", true);
lockPref("network.dns.disablePrefetchFromHTTPS", true);
lockPref("network.dns.prefetch_via_proxy", false);
lockPref("network.http.speculative-parallel-limit", 0);
lockPref("network.predictor.enable-hover-on-ssl", false);
lockPref("network.predictor.enable-prefetch", false);
lockPref("network.predictor.enabled", false);
lockPref("network.prefetch-next", false);

// Disable Preconnect
lockPref("network.preconnect", false);

// Prevent middle mouse clicks from pasting clipboard contents by default
lockPref("middlemouse.paste", false);

// Prevent middle mouse clicks on new tab button opening URLs or searches from clipboard
lockPref("browser.tabs.searchclipboardfor.middleclick", false);
lockPref("middlemouse.contentLoadURL", false);

/* -----------------------------------------------------------------------------------
   009 SEARCH & URL BAR
   ----------------------------------------------------------------------------------- */

// Hide using a different search engine in normal vs. private Windows
lockPref("browser.search.separatePrivateDefault.ui.enabled", false);

// Always show Punycode
lockPref("network.IDN_show_punycode", true);

// Disable search suggestions by default
lockPref("browser.search.suggest.enabled", false);
lockPref("browser.search.suggest.enabled.private", false);

// Use the same search engine in normal and private browsing windows by default
lockPref("browser.search.separatePrivateDefault", false);

/* -----------------------------------------------------------------------------------
   010 DNS
   ----------------------------------------------------------------------------------- */

// Disable DoH Connectivity Checks
lockPref("network.connectivity-service.DNS_HTTPS.domain", "");
lockPref("network.trr.confirmationNS", "skip");
lockPref("network.trr.skip-check-for-blocked-host", true);

// Disable EDNS Client Subnet (ECS) to prevent leaking general location data to authoritative DNS servers...
lockPref("network.trr.disable-ECS", true);

// Disable falling back to system DNS by default
lockPref("network.trr.retry_on_recoverable_errors", true);
lockPref("network.trr.strict_native_fallback", true);

// Disable nsNotifyAddrListener
lockPref("network.notify.changed", false);
lockPref("network.notify.checkForNRPT", false);
lockPref("network.notify.checkForProxies", false);
lockPref("network.notify.dnsSuffixList", false);
lockPref("network.notify.initial_call", false);
lockPref("network.notify.IPv6", false);
lockPref("network.notify.resolvers", false);

// Enable DNS Rebinding Protection
lockPref("network.trr.allow-rfc1918", false);

// Enable DoH without fallback & Set to Quad9 by default
lockPref("network.trr.default_provider_uri", "https://dns.quad9.net/dns-query");
lockPref("network.trr.mode", 3);

// Enable EncryptedClientHello
lockPref("network.dns.echconfig.enabled", true);
lockPref("network.dns.http3_echconfig.enabled", true);

// Enable native DNS HTTPS Lookups
lockPref("network.dns.native_https_query", true);

// Ensure we clear cache upon changing DoH prefs
lockPref("network.trr.clear-cache-on-pref-change", true);

// Fix IPv6 connectivity when DoH is enabled
lockPref("network.dns.preferIPv6", true);

// Prevent bypassing DoH for /etc/HOSTS entries by default
lockPref("network.trr.exclude-etc-hosts", false);

// Prevent sending headers for DoH requests
lockPref("network.trr.send_accept-language_headers", false);
lockPref("network.trr.send_empty_accept-encoding_headers", true);
lockPref("network.trr.send_user-agent_headers", false);

/* -----------------------------------------------------------------------------------
   011 PROXIES
   ----------------------------------------------------------------------------------- */

// Prevent from automatically using the system's proxy configuration by default
lockPref("network.proxy.type", 0);

// Always start proxy extensions (if installed) as soon as possible, instead of waiting for the first browser window to open
lockPref("extensions.webextensions.early_background_wakeup_on_request", true);

// Disable automatic failover from the proxy (if configured) to direct connections when certain system requests fail
lockPref("network.proxy.failover_direct", false);

// Disable file://net
lockPref("network.file.path_blacklist", "/net"); 

// Disable GIO
lockPref("network.gio.supported-protocols", "");

// Disable Uniform Naming Convention (UNC) file paths
lockPref("network.file.disable_unc_paths", true);

// Disable Wi-Fi Tickler
lockPref("network.tickle-wifi.enabled", false);

// Prevent bypassing the proxy (if configured) for system connections that include the `bypassProxy` flag
lockPref("network.proxy.allow_bypass", false);

// Use the proxy (if configured) for remote DNS lookups
lockPref("network.proxy.socks_remote_dns", true);
lockPref("network.proxy.socks5_remote_dns", true);

/* -----------------------------------------------------------------------------------
   012 WEBRTC 
   ----------------------------------------------------------------------------------- */

// Allow user to silence notifications when screen sharing
lockPref("privacy.webrtc.allowSilencingNotifications", true); 
lockPref("privacy.webrtc.hideGlobalIndicator", false); 

// Always sandbox Media Transport
lockPref("media.peerconnection.mtransport_process", true); 

// Enable global toggles for muting the camera/microphone
lockPref("privacy.webrtc.globalMuteToggles", true);

// Enable mDNS Host Obfuscation to prevent leaking local IP addresses
lockPref("media.peerconnection.ice.obfuscate_host_addresses", true);

// Prevent WebRTC from bypassing the proxy (if configured)
lockPref("media.peerconnection.ice.proxy_only_if_behind_proxy", true);

// Warn users when attempting to switch tabs in a window being shared over WebRTC
lockPref("privacy.webrtc.sharedTabWarning", true);

/* -----------------------------------------------------------------------------------
   013 MEDIA
   ----------------------------------------------------------------------------------- */

// Block media autoplay by default
lockPref("media.autoplay.default", 5);
lockPref("media.geckoview.autoplay.request.testing", 2);

// Disable Encrypted Media Extensions (EME) (DRM)
lockPref("media.eme.enabled", false);
lockPref("media.eme.require-app-approval", true);

// Disable Gecko Media Plugins (GMP)
lockPref("media.gmp-manager.updateEnabled", false);

// Disable GMP local sources
lockPref("media.gmp-manager.allowLocalSources", false);

// Disable GMP logging by default (to expose via the `about:config`)
lockPref("media.gmp.log.dump", false);
lockPref("media.gmp.log.level", 70);

// Disable OpenH264 (in favor of hardware decoding)
lockPref("media.ffmpeg.allow-openh264", false);
lockPref("media.gmp-gmpopenh264.enabled", false);
lockPref("media.gmp-gmpopenh264.visible", false);
lockPref("media.webrtc.hw.h264.enabled", true);

// Enable click to play UI for certain CSS skins by default
lockPref("userContent.player.click_to_play", true); 

// If GMP is enabled (via `media.gmp-manager.updateEnabled`), ensure that installed plug-ins are visible/exposed in `about:addons`
lockPref("media.gmp-provider.enabled", true);

// Sandbox GMP  
lockPref("media.gmp.insecure.allow", false); 

// Validate signature when updating GMP (if enabled)
lockPref("media.gmp-manager.cert.checkAttributes", true);
lockPref("media.gmp-manager.cert.requireBuiltIn", true);
lockPref("media.gmp-manager.checkContentSignature", true);

/* -----------------------------------------------------------------------------------
   014 ATTACK SURFACE REDUCTION
   ----------------------------------------------------------------------------------- */

// Disable ASM.JS
lockPref("javascript.options.asmjs", false);

// Disable Graphite & SVG OpenType fonts
lockPref("gfx.font_rendering.graphite.enabled", false);
lockPref("gfx.font_rendering.opentype_svg.enabled", false);

// Disable JavaScript Just-in-time Compilation (JIT)
lockPref("javascript.options.baselinejit", false);
lockPref("javascript.options.ion", false);
lockPref("javascript.options.jithints", false);
lockPref("javascript.options.main_process_disable_jit", true);
lockPref("javascript.options.native_regexp", false);
lockPref("javascript.options.wasm_optimizingjit", false);

// Disable JPEG-XL
lockPref("image.jxl.enabled", false);

// Disable MathML
lockPref("mathml.disabled", true);

// Disable shared memory allocation from the parent process to content processes
lockPref("javascript.options.self_hosted.use_shared_memory", false);

// Disable SharedArrayBuffer using window.postMessage
lockPref("dom.postMessage.sharedArrayBuffer.bypassCOOP_COEP.insecure.enabled", false);

// Disable WebVR/WebXR
lockPref("permissions.default.xr", 2);

// If JIT (Ion/WarpMonkey) is disabled, also disable it for extensions
lockPref("javascript.options.jit_trustedprincipals", false); 

/* -----------------------------------------------------------------------------------
   015 PASSWORDS & AUTHENTICATION
   ----------------------------------------------------------------------------------- */

// Allow filling passwords on all websites, even if they try to block it...
lockPref("signon.storeWhenAutocompleteOff", true);

// Always display a `reveal password` button in `password` `<input>` types 
lockPref("layout.forms.reveal-password-button.enabled", true);

// Crash on insecure password input
lockPref("intl.allow-insecure-text-input", false);

// Disable Autofill
lockPref("signon.autofillForms", false);
lockPref("signon.autofillForms.http", false);

// Disable Basic authentication over HTTP
lockPref("network.http.basic_http_auth.enabled", false);

// Disable formless capture of log-in credentials
lockPref("signon.formlessCapture.enabled", false);
lockPref("signon.privateBrowsingCapture.enabled", false);

// Disable Microsoft SSO
lockPref("network.http.microsoft-entra-sso.container-enabled.0", false);
lockPref("network.http.microsoft-entra-sso.enabled", false);
lockPref("network.http.windows-sso.container-enabled.0", false);
lockPref("network.http.windows-sso.enabled", false);
lockPref("network.microsoft-sso-authority-list", "");

// Disable NTLM
lockPref("network.auth.force-generic-ntlm", false);
lockPref("network.auth.force-generic-ntlm-v1", false);
lockPref("network.automatic-ntlm-auth.allow-non-fqdn", false);
lockPref("network.automatic-ntlm-auth.allow-proxies", false);
lockPref("network.automatic-ntlm-auth.trusted-uris", "");

// Disable NTLM/SPNEGO SSO in Private Browsing
lockPref("network.auth.private-browsing-sso", false);

// Disable Password Manager by default - Insecure & unencrypted
lockPref("extensions.formautofill.addresses.enabled", false);
lockPref("extensions.formautofill.creditCards.enabled", false);

// Disable password truncation
lockPref("editor.truncate_user_pastes", false);

// Disable SPNEGO
lockPref("network.negotiate-auth.allow-non-fqdn", false);
lockPref("network.negotiate-auth.allow-proxies", false);
lockPref("network.negotiate-auth.delegation-uris", "");
lockPref("network.negotiate-auth.trusted-uris", "");

// Enable anti-spoof confirmation prompts
lockPref("network.auth.confirmAuth.enabled", true);

// Enable strong password generation (if the Password Manager is enabled) by default
lockPref("signon.generation.enabled", true);

// If the PaymentRequest API is enabled, ensure we always require user interaction...
lockPref("dom.payments.request.user_interaction_required", true);

// Prevent cross-origin sub-resources from opening HTTP authentication dialogs to protect against phishing
lockPref("network.auth.subresource-img-cross-origin-http-auth-allow", false);

/* -----------------------------------------------------------------------------------
   016 EXTENSIONS
   ----------------------------------------------------------------------------------- */

// Always allow installing "incompatible" add-ons
lockPref("extensions.strictCompatibility", false);

// Always run extensions OOP (out of process...)
lockPref("extensions.webextensions.remote", true);

// Clear default list of sites allowed to install add-ons
lockPref("xpinstall.whitelist.add", "");

// Disable add-on sideloading
lockPref("extensions.autoDisableScopes", 15);
lockPref("extensions.enabledScopes", 5);
lockPref("extensions.installDistroAddons", false);
lockPref("extensions.sideloadScopes", 0);
lockPref("extensions.startupScanScopes", 0); 

// Disable the AMO Abuse Report API (`navigator.mozAddonManager.reportAbuse`)
lockPref("extensions.addonAbuseReport.url", "");

// Disable installation of add-ons by default [DESKTOP]
lockPref("xpinstall.enabled", false);

// Disable mozAddonManager
lockPref("extensions.webapi.testing", false);
lockPref("extensions.webapi.testing.http", false);
lockPref("privacy.resistFingerprinting.block_mozAddonManager", true);

// Enable Add-on Distribution Control (Install Origins)
lockPref("extensions.install_origins.enabled", true);

// Enable optional permission prompts
lockPref("extensions.webextOptionalPermissionPrompts", true);

// Enable Mozilla's Extension Blocklist
lockPref("extensions.blocklist.enabled", true);

// Enable Manifest V3
lockPref("extensions.manifestV3.enabled", true);

// Enable userScripts
lockPref("extensions.userScripts.mv3.enabled", true);
lockPref("extensions.webextensions.userScripts.enabled", true);

// Ensure Web Compatibility interventions use the MV3 API instead of the older MV2 one
lockPref("extensions.webcompat.useScriptingAPI", true);

// Harden CSP policy
lockPref("extensions.webextensions.base-content-security-policy", "script-src 'self' 'unsafe-inline'; upgrade-insecure-requests;");
lockPref("extensions.webextensions.base-content-security-policy.v3", "script-src 'self'; upgrade-insecure-requests;");
lockPref("extensions.webextensions.default-content-security-policy", "script-src 'self'; upgrade-insecure-requests;");
lockPref("extensions.webextensions.default-content-security-policy.v3", "script-src 'self'; upgrade-insecure-requests;");

// Never allow installing extensions without first prompting the user
lockPref("extensions.postDownloadThirdPartyPrompt", false);
lockPref("xpinstall.whitelist.directRequest", false);
lockPref("xpinstall.whitelist.fileRequest", false);
lockPref("xpinstall.whitelist.required", true);

// Only allow installation and updates of extensions using Firefox's built-in certificates by default
lockPref("extensions.install.requireBuiltInCerts", true);
lockPref("extensions.update.requireBuiltInCerts", true);

// Prevent automatically granting MV3 extensions optional host permissions by default
lockPref("extensions.originControls.grantByDefault", false);

// Prevent extensions from opening pop-ups to remote websites
lockPref("extensions.manifestV2.actionsPopupURLRestricted", true);

// Prevent extensions from opening pop-ups without user interaction
lockPref("extensions.openPopupWithoutUserGesture.enabled", false);

// Prevent extensions from using the Gecko Profiler
lockPref("extensions.geckoProfiler.acceptedExtensionIds", ""); 

// Prevent unprivileged extensions from accessing experimental APIs by default
lockPref("extensions.experiments.enabled", false);

// Prevent hiding extensions 
lockPref("devtools.aboutdebugging.showHiddenAddons", true);

// Require resources loaded by MV2 extensions to be specified under web_accessible_resources in the extension's manifest
lockPref("extensions.content_web_accessible.enabled", true);

// Require secure origins to install add-ons
lockPref("extensions.install.requireSecureOrigin", true);

/* -----------------------------------------------------------------------------------
   018 GEOLOCATION
   ----------------------------------------------------------------------------------- */

// Disable logging network geolocation requests by default
lockPref("geo.provider.network.logging.enabled", false);  

// Disable Mozilla's GeoIP/Region Service
lockPref("browser.region.local-geocoding", false); 
lockPref("browser.region.network.scan", false);
lockPref("browser.region.network.url", "");
lockPref("browser.region.update.enabled", false);
lockPref("browser.search.region", "US");
lockPref("doh-rollout.home-region", "US");

// Do not force the use of the network geolocation provider by default
lockPref("geo.provider.testing", false); 
lockPref("geo.provider.use_mls", false); 

// Enable network request cache for the network geolocation provider by default
lockPref("geo.provider.network.debug.requestCache.enabled", true); 

// Prevent unconditionally providing high location accuracy 
lockPref("geo.provider.geoclue.always_high_accuracy", false);

// Set BeaconDB as the default network geolocation provider
lockPref("geo.provider.network.url", "https://api.beacondb.net/v1/geolocate");

/* -----------------------------------------------------------------------------------
   019 PDF.js
   ----------------------------------------------------------------------------------- */

// Disable Automatic Alt Text by default
lockPref("pdfjs.enableAltTextModelDownload", false);

// Disable automatic hyperlinks
lockPref("pdfjs.enableAutoLinking", false);

// Disable JavaScript
lockPref("pdfjs.enableScripting", false);

// Disable XFA
lockPref("pdfjs.enableXfa", false);

// Enable the ability to add signatures
lockPref("pdfjs.enableSignatureEditor", true);

// Enable Alt Text
lockPref("pdfjs.enableAltText", true);
lockPref("pdfjs.enableAltTextForEnglish", true);
lockPref("pdfjs.enableGuessAltText", true);
lockPref("pdfjs.enableNewAltTextWhenAddingImage", true);
lockPref("pdfjs.enableUpdatedAddImage", true);

// Enforce using the internal font renderer
lockPref("pdfjs.disableFontFace", true);

// Ensure users can select and interact with text
lockPref("pdfjs.textLayerMode", 1);

// Force PDFs to be downloaded/viewed locally, and prompt before opening the PDF Viewer
lockPref("browser.download.open_pdf_attachments_inline", false);
lockPref("pdfjs.disableRange", true);
lockPref("pdfjs.disableStream", true);

// Never allow documents to prevent copying text
lockPref("pdfjs.enablePermissions", false);

// Open external links in new tabs/windows
lockPref("pdfjs.externalLinkTarget", 2);

// Prevent attempting to load/convert unknown binary files
lockPref("pdfjs.handleOctetStream", false);

// Show sidebar by default when viewing PDFs
lockPref("pdfjs.sidebarViewOnLoad", 2);

// Update URL when changing pages
lockPref("pdfjs.historyUpdateUrl", true);

/* -----------------------------------------------------------------------------------
   020 SAFE BROWSING
   ----------------------------------------------------------------------------------- */

// By default, when you report a Safe Browsing false positive, it sends the URL to both Mozilla & Google (NOT PROXIED), as well as your locale to Mozilla
lockPref("browser.safebrowsing.provider.google.reportMalwareMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");
lockPref("browser.safebrowsing.provider.google.reportPhishMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");
lockPref("browser.safebrowsing.provider.google4.reportMalwareMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");
lockPref("browser.safebrowsing.provider.google4.reportPhishMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");
lockPref("browser.safebrowsing.provider.google5.reportMalwareMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");
lockPref("browser.safebrowsing.provider.google5.reportPhishMistakeURL", "https://safebrowsing.google.com/safebrowsing/report_error/?tpl=mozilla&url=");

// Similar behavior also appears to happen when you report a URL to Safe Browsing
lockPref("browser.safebrowsing.reportPhishURL", "https://safebrowsing.google.com/safebrowsing/report_phish/?tpl=mozilla&url=");

// Disable the legacy (v2.2) Safe Browsing API
lockPref("browser.safebrowsing.provider.google.advisoryName", "Google Safe Browsing (Legacy)");
lockPref("browser.safebrowsing.provider.google.lists", "disabled");
lockPref("browser.safebrowsing.provider.google.lists.default", "goog-badbinurl-shavar,goog-downloadwhite-digest256,goog-phish-shavar,googpub-phish-shavar,goog-malware-shavar,goog-unwanted-shavar");

// Enable an additional plug-in blocklist from Mozilla
lockPref("urlclassifier.blockedTable", "moztest-block-simple,mozplugin-block-digest256");

// Enable the Potentially Harmful Application list (when Safe Browsing is enabled)
lockPref("urlclassifier.malwareTable", "goog-malware-proto,goog-unwanted-proto,moztest-harmful-simple,moztest-malware-simple,moztest-unwanted-simple,goog-harmful-proto");

// Enable Safe Browsing by default
lockPref("browser.safebrowsing.blockedURIs.enabled", true);
lockPref("browser.safebrowsing.downloads.enabled", true);
lockPref("browser.safebrowsing.id", "navclient-auto-ffox");
lockPref("browser.safebrowsing.malware.enabled", true);
lockPref("browser.safebrowsing.phishing.enabled", true);
lockPref("browser.safebrowsing.provider.google5.advisoryURL", "https://developers.google.com/safe-browsing/v4/advisory");
lockPref("browser.safebrowsing.provider.google5.enabled", true);
lockPref("browser.safebrowsing.provider.google5.lists", "goog-phish-proto,googpub-phish-proto,goog-malware-proto,goog-unwanted-proto,goog-harmful-proto");
lockPref("browser.safebrowsing.provider.mozilla.gethashURL", "https://shavar.services.mozilla.com/gethash?client=navclient-auto-ffox&appver=%MAJOR_VERSION%&pver=2.2");
lockPref("browser.safebrowsing.update.enabled", true);
lockPref("urlclassifier.downloadAllowTable", "goog-downloadwhite-proto");
lockPref("urlclassifier.downloadBlockTable", "goog-badbinurl-proto");
lockPref("urlclassifier.phishTable", "goog-phish-proto,moztest-phish-simple");

// Ensure users can override Safe Browsing warnings by default
lockPref("browser.safebrowsing.allowOverride", true);

// Prevent sending metadata of downloaded files to Safe Browsing providers
lockPref("browser.safebrowsing.downloads.remote.enabled", false);

// Prevent sharing data/telemetry with Safe Browsing providers
lockPref("browser.safebrowsing.provider.google.dataSharing.enabled", false);
lockPref("browser.safebrowsing.provider.google.dataSharingURL", "");
lockPref("browser.safebrowsing.provider.google4.dataSharing.enabled", false);
lockPref("browser.safebrowsing.provider.google4.dataSharingURL", "");
lockPref("browser.safebrowsing.provider.google5.dataSharing.enabled", false);
lockPref("browser.safebrowsing.provider.google5.dataSharingURL", "");
lockPref("browser.safebrowsing.provider.mozilla.dataSharing.enabled", false);
lockPref("browser.safebrowsing.provider.mozilla.dataSharingURL", "");
lockPref("browser.safebrowsing.provider.test.dataSharing.enabled", false);
lockPref("browser.safebrowsing.provider.test.dataSharingURL", "");

// Unbreak Google's download protection and legacy Safe Browsing provider
lockPref("browser.safebrowsing.downloads.remote.url", "https://sb-ssl.google.com/safebrowsing/clientreport/download?key=%GOOGLE_SAFEBROWSING_API_KEY%");
lockPref("browser.safebrowsing.provider.google.gethashURL", "https://safebrowsing.google.com/safebrowsing/gethash?client=navclient-auto-ffox&appver=%MAJOR_VERSION%&pver=2.2");
lockPref("browser.safebrowsing.provider.google.updateURL", "https://safebrowsing.google.com/safebrowsing/downloads?client=navclient-auto-ffox&appver=%MAJOR_VERSION%&pver=2.2&key=%GOOGLE_SAFEBROWSING_API_KEY%");

// Unclear whether these are actually used or not, but looks like Firefox has some kind of functionality to view a "report" from Safe Browsing about the safety, history, and general status of a site
lockPref("browser.safebrowsing.provider.google.reportURL", "https://transparencyreport.google.com/safe-browsing/search?url=");
lockPref("browser.safebrowsing.provider.google4.reportURL", "https://transparencyreport.google.com/safe-browsing/search?url=");
lockPref("browser.safebrowsing.provider.google5.reportURL", "https://transparencyreport.google.com/safe-browsing/search?url=");

/* -----------------------------------------------------------------------------------
   021 MISC. PRIVACY + SECURITY
   ----------------------------------------------------------------------------------- */

// Disable Accessibility Services
lockPref("accessibility.force_disabled", 1);
lockPref("devtools.accessibility.enabled", false);

// Disable automatic updates for OpenSearch engines
lockPref("browser.search.update", false);

// Disable Battery API (Navigator.getBattery)
lockPref("dom.battery.enabled", false);

// Disable Beacon API (Navigator.sendBeacon)
lockPref("beacon.enabled", false);

// Disable Clipboard API
lockPref("dom.events.asyncClipboard.clipboardItem", false);
lockPref("dom.events.asyncClipboard.readText", false);
lockPref("dom.events.testing.asyncClipboard", false);

// Disable Content Analysis SDK
lockPref("browser.contentanalysis.default_result", 0);
lockPref("browser.contentanalysis.enabled", false);
lockPref("browser.contentanalysis.interception_point.clipboard.enabled", false);
lockPref("browser.contentanalysis.interception_point.drag_and_drop.enabled", false);
lockPref("browser.contentanalysis.interception_point.file_upload.enabled", false);
lockPref("browser.contentanalysis.interception_point.print.enabled", false);
lockPref("browser.contentanalysis.max_connections", 0);
lockPref("browser.contentanalysis.show_blocked_result", true);
lockPref("browser.contentanalysis.silent_notifications", false);

// Disable Federated Credential Management (FedCM) API
lockPref("dom.security.credentialmanagement.identity.enabled", false);
lockPref("dom.security.credentialmanagement.identity.heavyweight.enabled", false);
lockPref("dom.security.credentialmanagement.identity.lightweight.enabled", false);

// Disable Reporting API
lockPref("dom.reporting.crash.enabled", false);
lockPref("dom.reporting.enabled", false);
lockPref("dom.reporting.featurePolicy.enabled", false);
lockPref("dom.reporting.header.enabled", false);
lockPref("dom.reporting.testing.enabled", false);

// Disable Web Share API
lockPref("dom.webshare.enabled", false);
lockPref("dom.webshare.requireinteraction", true);

// Disable WebGPU
lockPref("dom.webgpu.enabled", false);

// Disable WebMIDI
lockPref("dom.sitepermsaddon-provider.enabled", false);
lockPref("dom.webmidi.gated", true);

// Enable Messaging Layer Security (MLS)
lockPref("dom.origin-trials.mls.state", 1);

// Enable Private Network Access Restrictions
lockPref("network.lna.block_trackers", true);
lockPref("network.lna.enabled", true);
lockPref("permissions.default.local-network", 2);
lockPref("permissions.default.localhost", 2);

// Prevent exposing XPCOM Components.interfaces to websites
lockPref("dom.use_components_shim", false);

/* -----------------------------------------------------------------------------------
   022 MISC. PRIVACY
   ----------------------------------------------------------------------------------- */

// Block ports currently known to be abused by Android apps for tracking/fingerprinting[
lockPref("network.security.ports.banned", "29009, 29010, 30102, 30103, 12387, 12388, 12580, 12581, 12582, 12583, 12584, 12585, 12586, 12587, 12588, 12589, 12590, 12591");

// Disable CSP reporting
lockPref("security.csp.reporting.enabled", false);

// Disable Hyperlink Auditing (Click Tracking)
lockPref("browser.send_pings", false);
lockPref("browser.send_pings.max_per_link", 1);
lockPref("browser.send_pings.require_same_host", true);

// Disable Network Error Logging
lockPref("network.http.network_error_logging.enabled", false);

// Disable online speech recognition
lockPref("media.webspeech.service.endpoint", "data;");

// Disable referers when leaving .onion domains
lockPref("network.http.referer.hideOnionSource", true);

// Disable storage access heuristics
lockPref("dom.storage_access.auto_grants", false);
lockPref("privacy.restrict3rdpartystorage.heuristic.navigation", false);
lockPref("privacy.restrict3rdpartystorage.heuristic.opened_window_after_interaction", false);
lockPref("privacy.restrict3rdpartystorage.heuristic.recently_visited", false);
lockPref("privacy.restrict3rdpartystorage.heuristic.redirect", false);
lockPref("privacy.restrict3rdpartystorage.heuristic.window_open", false);

// Disable TLS session identifiers
lockPref("security.ssl.disable_session_identifiers", true);

// Enable Cookie Banner Reduction
lockPref("cookiebanners.bannerClicking.enabled", true);
lockPref("cookiebanners.cookieInjector.enabled", true);
lockPref("cookiebanners.service.mode", 1);
lockPref("cookiebanners.service.mode.privateBrowsing", 1);
lockPref("cookiebanners.service.enableGlobalRules", true);
lockPref("cookiebanners.service.enableGlobalRules.subFrames", true);

// Enable Cookies Having Independent Partitioned State (CHIPS)
lockPref("network.cookie.CHIPS.enabled", true);
lockPref("network.cookie.chips.partitionLimitDryRun", false);

// Enable Do Not Track & Global Privacy Control
lockPref("privacy.donottrackheader.enabled", true);
lockPref("privacy.globalprivacycontrol.enabled", true);
lockPref("privacy.globalprivacycontrol.functionality.enabled", true);
lockPref("privacy.globalprivacycontrol.pbmode.enabled", true);

// Exclude third party trackers from storage access heuristics (if enabled)
lockPref("dom.storage_access.auto_grants.exclude_third_party_trackers", true);
lockPref("privacy.restrict3rdpartystorage.heuristic.exclude_third_party_trackers", true);

// Improve built-in query stripping to be on par with LibreWolf and Brave
lockPref("privacy.query_stripping.strip_list", "__hsfp __hssc __hstc __s _bhlid _branch_match_id _branch_referrer _gl _hsenc _kx _openstat at_recipient_id at_recipient_list bbeml bsft_clkid bsft_uid dclid et_rid fb_action_ids fb_comment_id fbclid gbraid gclid guce_referrer guce_referrer_sig hsCtaTracking igshid irclickid mc_eid mkt_tok ml_subscriber ml_subscriber_hash msclkid mtm_cid oft_c oft_ck oft_d oft_id oft_ids oft_k oft_lk oft_sk oly_anon_id oly_enc_id pk_cid rb_clickid s_cid sc_customer sc_eh sc_uid srsltid ss_email_id twclid unicorn_click_id vero_conv vero_id vgo_ee wbraid wickedid yclid ymclid ysclid");

// Isolate resources (ex. referrers & cookies) injected by extensions
lockPref("privacy.antitracking.isolateContentScriptResources", true);

// Limit maximum cookie lifetime to 6 months/180 days (Like Brave)
lockPref("network.cookie.maxageCap", 15552000);

// Prevent sharing identifying information if a remote AutoConfig is being used
lockPref("autoadmin.append_emailaddr", false);

// Prevent third parties from setting cookies unless the third party already has cookies as a first party (Like Safari)
lockPref("privacy.dynamic_firstparty.limitForeign", true);

// Restrict tracking referers
lockPref("network.http.referer.defaultPolicy.trackers", 1);
lockPref("network.http.referer.defaultPolicy.trackers.pbmode", 1);

// Strip tracking parameters from URLs when shared by default
lockPref("privacy.query_stripping.strip_on_share.enabled", true);

// Trim cross-origin referers (Like Safari)
lockPref("network.http.referer.XOriginTrimmingPolicy", 2);

/* -----------------------------------------------------------------------------------
   023 MISC. SECURITY
   ----------------------------------------------------------------------------------- */

// Always prompt users for a certificate when websites request one, rather than automatically selecting one...
lockPref("security.default_personal_cert", "Ask Every Time");

// Always warn users before launching other apps
lockPref("network.protocol-handler.warn-external-default", true);

// Apply CSP to internal browser.xhtml
lockPref("security.browser_xhtml_csp.enabled", true);
lockPref("security.browser_xhtml_csp.report-only", false);

// Decrease the lifetime of extension processes
lockPref("dom.ipc.keepProcessesAlive.extension", 0);

// Decrease the lifetime of privileged processes for `about:` pages
lockPref("dom.ipc.keepProcessesAlive.privilegedabout", 0);

// Decrease the lifetime of web content processes
lockPref("dom.ipc.keepProcessesAlive.web", 0);

// Disable Navigator Media Objects & getUserMedia Support in insecure contexts
lockPref("media.devices.insecure.enabled", false);
lockPref("media.getusermedia.insecure.enabled", false);

// Do not allow additional ports by default
lockPref("network.security.ports.banned.override", "");

// Enable content process sandboxing
lockPref("security.sandbox.content.level", 6);

// Enable the Cross-Origin-Embedder Policy Header
lockPref("browser.tabs.remote.coep.credentialless", true);
lockPref("browser.tabs.remote.useCrossOriginEmbedderPolicy", true);
lockPref("dom.origin-trials.coep-credentialless.state", 1);

// Enable the Cross-Origin-Opener Policy Header
lockPref("browser.tabs.remote.useCrossOriginOpenerPolicy", true);

// Enable Element.setHTML
lockPref("dom.security.setHTML.enabled", true);

// Enable GPU Sandboxing
lockPref("security.sandbox.gpu.level", 2);

// Enable the Integrity-Policy header
lockPref("security.integrity_policy.enabled", true);
lockPref("security.integrity_policy.stylesheet.enabled", true);


// Enable Opaque Response Blocking
lockPref("browser.opaqueResponseBlocking", true);
lockPref("browser.opaqueResponseBlocking.javascriptValidator", true);

// Enable Origin-keyed agent clustering by default (Like Chromium)
lockPref("dom.origin_agent_cluster.default", true);
lockPref("dom.origin_agent_cluster.enabled", true);

// Enforce Per-site Process Isolation + isolate all websites
lockPref("browser.sessionstore.disable_platform_collection", false);
lockPref("fission.autostart", true);
lockPref("fission.autostart.session", true);
lockPref("fission.disableSessionHistoryInParent", false);
lockPref("fission.webContentIsolationStrategy", 1);
lockPref("gfx.webrender.all", true);

// Enable the Sanitizer API
lockPref("dom.security.sanitizer.enabled", true);

// Enable socket process sandboxing
lockPref("security.sandbox.socket.process.level", 1);

// Enable Spectre mitigations for isolated content
lockPref("javascript.options.spectre.disable_for_isolated_content", false);

// Enable WebAssembly Memory Control
lockPref("javascript.options.wasm_memory_control", true);

// Enforce strict file:// Origin Policy
lockPref("security.fileuri.strict_origin_policy", true);

// Enforce various important security-related prefs
lockPref("dom.block_external_protocol_in_iframes", true);
lockPref("dom.block_external_protocol_navigation_from_sandbox", true);
lockPref("security.all_resource_uri_content_accessible", false);
lockPref("security.allow_eval_in_parent_process", false);
lockPref("security.allow_eval_with_system_principal", false);
lockPref("security.allow_parent_unrestricted_js_loads", false);
lockPref("security.allow_unsafe_parent_loads", false);
lockPref("security.data_uri.block_toplevel_data_uri_navigations", true);

// Ensure we block old/obsolete libavcodec libraries
lockPref("media.libavcodec.allow-obsolete", false);

// Never expose shell access
lockPref("network.protocol-handler.external.shell", false);

// Never skip the assertion that about:pages don't have content security policies (CSP)
lockPref("dom.security.skip_about_page_has_csp_assert", false);

// Prefer to create new content processes, instead of re-using existing ones
lockPref("browser.tabs.remote.subframesPreferUsed", false);

// Prevent marking JIT code pages as both writable and executable, only one or the other...
lockPref("javascript.options.content_process_write_protect_code", true);

// Prevent AutoConfig files (if being used) from gaining privileged browser access...
lockPref("general.config.sandbox_enabled", true);

// Prevent remoteTypes from triggering process switches they shouldn't be able to...
lockPref("browser.tabs.remote.enforceRemoteTypeRestrictions", true);

// Protect against CSRF Attacks (Like Chromium)
lockPref("network.cookie.sameSite.laxByDefault", true);
lockPref("network.cookie.sameSite.noneRequiresSecure", true);
lockPref("network.cookie.sameSite.schemeful", true);

// Protect against MIME Exploits
lockPref("dom.workers.importScripts.enforceStrictMimeType", true);
lockPref("network.sniff.use_extension", true);
lockPref("security.block_fileuri_script_with_wrong_mime", true);
lockPref("security.block_Worker_with_wrong_mime", true);

// Sandbox AudioIPC (cubeb)
lockPref("media.cubeb.sandbox", true);

// Use a separate content process for `file://` URLs
lockPref("browser.tabs.remote.separateFileUriProcess", true);

// Warn on unprivileged namespaces
lockPref("security.sandbox.warn_unprivileged_namespaces", true);

// Yes, this is a real pref...
lockPref("security.turn_off_all_security_so_that_viruses_can_take_over_this_computer", false);

/* -----------------------------------------------------------------------------------
   024 MISC.
   ----------------------------------------------------------------------------------- */

// Block pop-ups by default
lockPref("dom.disable_open_during_load", true);

// Disable Captive Portal Detection & Connectivity Checks
lockPref("captivedetect.canonicalURL", "");
lockPref("network.captive-portal-service.enabled", false);
lockPref("network.connectivity-service.DNSv4.domain", "");
lockPref("network.connectivity-service.DNSv6.domain", "");
lockPref("network.connectivity-service.enabled", false);
lockPref("network.connectivity-service.IPv4.url", "");
lockPref("network.connectivity-service.IPv6.url", "");
lockPref("network.trr.wait-for-portal", false);

// Disable network connectivity status monitoring
lockPref("network.manage-offline-status", false);
lockPref("network.offline-mirrors-connectivity", false);

// Disable network requests to 0.0.0.0
lockPref("network.socket.ip_addr_any.disabled", true);

// Disable WebVTT Testing Events
lockPref("media.webvtt.testing.events", false);

// Enable Firefox's newer 'Felt privacy' design for Certificate Errors
lockPref("security.certerrors.felt-privacy-v1", true);

// Enable more detailed property error messages
lockPref("javascript.options.property_error_message_fix", true);

// Force pop-up windows to open in new tabs instead
lockPref("browser.link.open_newwindow", 3);
lockPref("browser.link.open_newwindow.restriction", 0);

// Limit what events can cause pop-ups
lockPref("dom.popup_allowed_events", "click dblclick");

// Prevent Safe Mode from automatically starting by default
lockPref("toolkit.startup.max_resumed_crashes", -1);

// Prevent scripts from moving, resizing, and messing with windows
lockPref("dom.allow_scripts_to_close_windows", false);
lockPref("dom.disable_window_flip", true);
lockPref("dom.disable_window_move_resize", true);

// Prevent websites from automatically refreshing
lockPref("browser.meta_refresh_when_inactive.disabled", true);

// Reject invalid cookies
lockPref("extensions.cookie.rejectWhenInvalid", true);

// Show an error page/details instead of a blank page for HTTP responses with certain error codes (ex. 4xx, 5xx, & Content-Length: 0)
lockPref("browser.http.blank_page_with_error_response.enabled", false);

/* -----------------------------------------------------------------------------------
   025 DEBUGGING
   ----------------------------------------------------------------------------------- */

// Allow inspecting the browser chrome by default
lockPref("devtools.chrome.enabled", false);

// Allow inspecting the DOM by default
lockPref("devtools.dom.enabled", false);

// Allow inspecting/debugging local tabs from `about:debugging` by default
lockPref("devtools.aboutdebugging.local-tab-debugging", true);

// Always prompt before connecting to Remote Debugging...
lockPref("devtools.debugger.prompt-connection", true);

// Disable editor onboarding
lockPref("devtools.webconsole.input.editorOnboarding", false);

// Disable network monitoring by default
lockPref("devtools.browserconsole.enableNetworkMonitoring", false);

// Disable pausing on debugger statements by default
lockPref("devtools.debugger.pause-on-debugger-statement", false);

// Disable Remote Debugging by default
lockPref("devtools.debugger.remote-enabled", false);

// Disable the Remote Debugging Web Socket
lockPref("devtools.debugger.remote-websocket", false);

// Display Web Console timestamps by default
lockPref("devtools.webconsole.timestampMessages", true);

// Disable WebDriver BiDi experimental commands and events
lockPref("remote.experimental.enabled", false);

// Enable the Anti tracking debug panel by default
lockPref("devtools.anti-tracking.enabled", true);

// Enable the Web Console sidebar toggle
lockPref("devtools.webconsole.sidebarToggle", true);

// Enforce local debugging only
lockPref("devtools.debugger.force-local", true);
lockPref("devtools.inspector.remote", false);

// Enforce system access checks for WebDriver
lockPref("remote.system-access-check.enabled", true);

// Highlight syntax when viewing the source of webpages (via `view-source:`)
lockPref("view_source.syntax_highlight", true);

// Pretty print code when debugging by default
lockPref("devtools.debugger.auto-pretty-print", true);

// Prevent adding global `dump` function to log strings to `stdout`
lockPref("browser.dom.window.dump.enabled", false);

// Prevent automatically clearing log messages after page reloads/navigation
lockPref("devtools.netmonitor.persistlog", true);
lockPref("devtools.webconsole.persistlog", true);

// Prevent console API from writing to `stdout` when used by chrome content
lockPref("devtools.console.stdout.chrome", false);

// Prevent logging URLs in Reader errors
lockPref("reader.errors.includeURLs", false);

// Prevent WebDriver from overriding preferences by default
lockPref("remote.prefs.recommended", false);

// Set Browser/Error Console scope to "Multiprocess" instead of "Parent process only" by default
lockPref("devtools.browsertoolbox.scope", "everything");

// Show default/browser styles in the Inspector by default
lockPref("devtools.inspector.showUserAgentStyles", true);

// Unbreak debugging if `localhost` can't be looked up via DNS
lockPref("devtools.debugger.chrome-debugging-host", "127.0.0.1");

// Wrap lines when debugging by default
lockPref("devtools.debugger.ui.editor-wrapping", true);

// Wrap lines when viewing the source of webpages (via `view-source:`)
lockPref("view_source.wrap_long_lines", true);

/* -----------------------------------------------------------------------------------
   026 PERFORMANCE
   ----------------------------------------------------------------------------------- */

// Compress cached JavaScript bytecode
lockPref("browser.cache.jsbc_compression_level", 3);

// Disable certain UI animations by default
lockPref("ui.panelAnimations", 0);
lockPref("ui.prefersReducedMotion", 1);
lockPref("ui.swipeAnimationEnabled", 0);

// Disable CSS error reporting by default
lockPref("layout.css.report_errors", false);

// Disable extra extension logging by default
lockPref("extensions.logging.enabled", false);

// Disable pacing requests
lockPref("network.http.pacing.requests.enabled", false);

// Enable Advanced Vector Extensions (AVX)
lockPref("javascript.options.wasm_simd_avx", true);

// Enable Branch Hinting
lockPref("javascript.options.wasm_branch_hinting", true);

// Enable Canvas2D acceleration (if supported)
lockPref("gfx.canvas.accelerated", true);
lockPref("gfx.canvas.accelerated.cache-items", 32768);
lockPref("gfx.canvas.accelerated.cache-size", 4096);

// Enable CSS Masonry Layout
lockPref("layout.css.grid-template-masonry-value.enabled", true);

// Enable the "fetchpriority" attribute
lockPref("network.fetchpriority.enabled", true);

// Enable JS GC Parallel Marking
lockPref("javascript.options.mem.gc_parallel_marking", true);

// Enable SIMD
lockPref("javascript.options.wasm_relaxed_simd", true);

// Enable the WebRender native compositor (if supported)
lockPref("gfx.webrender.compositor", true);

// Increase buffering for video playback
lockPref("media.cache_readahead_limit", 600);
lockPref("media.cache_readahead_limit.cellular", 600);
lockPref("media.cache_resume_threshold", 300);
lockPref("media.cache_resume_threshold.cellular", 300);
lockPref("media.throttle-cellular-regardless-of-download-rate", false);

// Increase the chunk size for calls to image decoders
lockPref("image.mem.decode_bytes_at_a_time", 65536);

// Increase DNS caching
lockPref("network.dnsCacheExpiration", 3600);
lockPref("network.dnsCacheExpirationGracePeriod", 120);
lockPref("network.dnsCacheEntries", 10000);

// Increase the file-backed media cache size for cellular connections
lockPref("media.cache_size.cellular", 512000);

// Increase the image cache size
lockPref("image.cache.size", 10485760);

// Increase the memory-backed media cache size
lockPref("media.memory_cache_max_size", 262144);
lockPref("media.memory_caches_combined_limit_kb", 1048576);

// Increase memory cache
lockPref("browser.cache.memory.capacity", 131072);
lockPref("browser.cache.memory.max_entry_size", 20480);

// Increase the skia font cache size (Similar to Chromium)
lockPref("gfx.content.skia-font-cache-size", 32);

// Increase the maximum number of HTTP connections
lockPref("network.http.max-connections", 1800);
lockPref("network.http.max-persistent-connections-per-proxy", 48);
lockPref("network.http.max-persistent-connections-per-server", 10);
lockPref("network.http.max-urgent-start-excessive-connections-per-host", 5);
lockPref("network.http.request.max-start-delay", 5);

// Increase TLS token caching
lockPref("network.ssl_tokens_cache_capacity", 10240);

// Use higher performance pinch-zoom
lockPref("gfx.webrender.low-quality-pinch-zoom", true);

/* -----------------------------------------------------------------------------------
   FINE
   ----------------------------------------------------------------------------------- */

// Controllo versione
lockPref("rischio.bird", "OK");
