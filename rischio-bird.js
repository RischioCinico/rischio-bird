
/* -----------------------------------------------------------------------------------
   001 DATA COLLECTION
   ----------------------------------------------------------------------------------- */

lockPref("toolkit.aboutLogging.uploadProfileToCloud", false);
lockPref("toolkit.aboutlogging.uploadProfileUrl", "");

lockPref("toolkit.coverage.enabled", false);
lockPref("toolkit.coverage.endpoint.base", "");
lockPref("toolkit.coverage.log-level", 70);
lockPref("toolkit.coverage.opt-out", true);
lockPref("toolkit.telemetry.coverage.opt-out", true);

lockPref("breakpad.reportURL", "");
lockPref("browser.crashReports.crashPull", false);
lockPref("browser.crashReports.requestedNeverShowAgain", true);
lockPref("browser.crashReports.unsubmittedCheck.autoSubmit2", false);
lockPref("browser.crashReports.unsubmittedCheck.enabled", false);
lockPref("toolkit.crashreporter.include_context_heap", false);

lockPref("browser.safebrowsing.features.emailtracking.datacollection.update", false);
lockPref("captchadetection.actor.enabled", false);
lockPref("captchadetection.hasUnsubmittedData", false);
lockPref("captchadetection.loglevel", "Off");
lockPref("datareporting.dau.cachedUsageProfileID", "beefbeef-beef-beef-beef-beeefbeefbee");
lockPref("datareporting.dau.cachedUsageProfileGroupID", "b0bacafe-b0ba-cafe-b0ba-cafeb0bacafe");
lockPref("datareporting.healthreport.uploadEnabled", false);
lockPref("datareporting.policy.dataSubmissionEnabled", false);
lockPref("datareporting.policy.dataSubmissionPolicyBypassNotification", true);
lockPref("datareporting.policy.firstRunURL", "");
lockPref("datareporting.usage.uploadEnabled", false);
lockPref("dom.security.unexpected_system_load_telemetry_enabled", false);
lockPref("extensions.dataCollectionPermissions.enabled", false);
lockPref("extensions.telemetry.EnvironmentAddonBuilder", false);
lockPref("network.jar.record_failure_reason", false);
lockPref("network.traffic_analyzer.enabled", false);
lockPref("network.trr.confirmation_telemetry_enabled", false);
lockPref("nimbus.telemetry.targetingContextEnabled", false);
lockPref("privacy.imageInputTelemetry.enableTestMode", false);
lockPref("privacy.trackingprotection.emailtracking.data_collection.enabled", false);
lockPref("telemetry.fog.aboutGlean.debugTag", "");
lockPref("telemetry.fog.artifact_build", false);
lockPref("telemetry.fog.test.activity_limit", -1);
lockPref("telemetry.fog.test.inactivity_limit", -1);
lockPref("telemetry.fog.init_on_shutdown", false);
lockPref("telemetry.fog.test.localhost_port", 70000);
lockPref("telemetry.glean.internal.finalInactive", false);
lockPref("telemetry.glean.internal.maxPingsPerMinute", 0);
lockPref("telemetry.number_of_site_origin.min_interval", 999999999);
lockPref("toolkit.content-background-hang-monitor.disabled", true);
lockPref("toolkit.telemetry.archive.enabled", false);
lockPref("toolkit.telemetry.bhrPing.enabled", false);
lockPref("toolkit.telemetry.cachedClientID", "c0ffeec0-ffee-c0ff-eec0-ffeec0ffeec0");
lockPref("toolkit.telemetry.cachedProfileGroupID", "decafdec-afde-cafd-ecaf-decafdecafde");
lockPref("toolkit.telemetry.collectInterval", 999999999);
lockPref("toolkit.telemetry.dap.helper.hpke", "");
lockPref("toolkit.telemetry.dap.helper.url", "");
lockPref("toolkit.telemetry.dap.leader.hpke", "");
lockPref("toolkit.telemetry.dap.leader.url", "");
lockPref("toolkit.telemetry.dap.logLevel", "Off");
lockPref("toolkit.telemetry.dap_enabled", false);
lockPref("toolkit.telemetry.dap_task1_enabled", false);
lockPref("toolkit.telemetry.dap_task1_taskid", "");
lockPref("toolkit.telemetry.dap_visit_counting_enabled", false);
lockPref("toolkit.telemetry.dap_visit_counting_experiment_list", "[]");
lockPref("toolkit.telemetry.debugSlowSql", false);
lockPref("toolkit.telemetry.enabled", false);
lockPref("toolkit.telemetry.eventping.maximumFrequency", 999999999);
lockPref("toolkit.telemetry.eventping.minimumFrequency", 999999999);
lockPref("toolkit.telemetry.firstShutdownPing.enabled", false);
lockPref("toolkit.telemetry.healthping.enabled", false);
lockPref("toolkit.telemetry.initDelay", 999999999);
lockPref("toolkit.telemetry.log.dump", false);
lockPref("toolkit.telemetry.log.level", "Fatal");
lockPref("toolkit.telemetry.minSubsessionLength", 999999999);
lockPref("toolkit.telemetry.newProfilePing.delay", 999999999);
lockPref("toolkit.telemetry.newProfilePing.enabled", false);
lockPref("toolkit.telemetry.overrideUpdateChannel", "release");
lockPref("toolkit.telemetry.previousBuildID", "");
lockPref("toolkit.telemetry.reportingpolicy.firstRun", false);
lockPref("toolkit.telemetry.scheduler.idleTickInterval", 999999999);
lockPref("toolkit.telemetry.scheduler.tickInterval", 999999999);
lockPref("toolkit.telemetry.send.overrideOfficialCheck", false);
lockPref("toolkit.telemetry.server", "data;");
lockPref("toolkit.telemetry.server_owner", "");
lockPref("toolkit.telemetry.shutdownPingSender.backgroundtask.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabled", false);
lockPref("toolkit.telemetry.shutdownPingSender.enabledFirstSession", false);
lockPref("toolkit.telemetry.testing.disableFuzzingDelay", false);
lockPref("toolkit.telemetry.testing.overridePreRelease", false);
lockPref("toolkit.telemetry.testing.overrideProductsCheck", false);
lockPref("toolkit.telemetry.testing.suppressPingsender", true);
lockPref("toolkit.telemetry.translations.logLevel", "Off");
lockPref("toolkit.telemetry.unified", false);
lockPref("toolkit.telemetry.untrustedModulesPing.frequency", 999999999);
lockPref("toolkit.telemetry.updatePing.enabled", false);
lockPref("toolkit.telemetry.user_characteristics_ping.current_version", 0);
lockPref("toolkit.telemetry.user_characteristics_ping.last_version_sent", 0);
lockPref("toolkit.telemetry.user_characteristics_ping.logLevel", "Off");
lockPref("toolkit.telemetry.user_characteristics_ping.opt-out", true);
lockPref("toolkit.telemetry.user_characteristics_ping.send-once", false);
lockPref("toolkit.telemetry.user_characteristics_ping.uuid", "");
lockPref("urlclassifier.features.emailtracking.datacollection.allowlistTables", "");
lockPref("urlclassifier.features.emailtracking.datacollection.blocklistTables", "");

lockPref("app.normandy.run_interval_seconds", 0);
lockPref("app.shield.optoutstudies.enabled", false);
lockPref("messaging-system.rsexperimentloader.collection_id", "");
lockPref("nimbus.appId", "");
lockPref("nimbus.profileId", "");
lockPref("nimbus.profilesdatastoreservice.enabled", false);
lockPref("nimbus.profilesdatastoreservice.read.enabled", false);
lockPref("nimbus.profilesdatastoreservice.sync.enabled", false);

lockPref("about.glean.redesign.enabled", false);

lockPref("dom.origin-trials.enabled", false);

lockPref("app.distributor", "");
lockPref("app.distributor.channel", "");
lockPref("mozilla.partner.id", "");

/* -----------------------------------------------------------------------------------
   002 MOZILLA CRAP
   ----------------------------------------------------------------------------------- */

// Clear unnecessary/undesired Mozilla URLs
lockPref("app.feedback.baseURL", "");
lockPref("datareporting.healthreport.infoURL", "");
lockPref("extensions.recommendations.privacyPolicyUrl", "");
lockPref("toolkit.datacollection.infoURL", "");

// Disable add-on/feature recommendations
lockPref("browser.discovery.enabled", false);
lockPref("browser.translations.mostRecentTargetLanguages", "en-US");
lockPref("browser.translations.panelShown", true);
lockPref("extensions.getAddons.browseAddons", "");
lockPref("extensions.getAddons.discovery.api_url", "data;");
lockPref("extensions.getAddons.showPane", false);
lockPref("extensions.htmlaboutaddons.recommendations.enabled", false);
lockPref("extensions.recommendations.hideNotice", true);
lockPref("extensions.recommendations.themeRecommendationUrl", "");
lockPref("extensions.ui.lastCategory", "addons://list/extension");
lockPref("extensions.webservice.discoverURL", "");

// Disable DoH Rollout/heuristics/steering
lockPref("doh-rollout._testing", true);
lockPref("doh-rollout.disable-heuristics", true);
lockPref("doh-rollout.doneFirstRun", true);
lockPref("doh-rollout.doorhanger-decision", "UIDisabled");
lockPref("doh-rollout.enabled", false);
lockPref("doh-rollout.mode", 5);
lockPref("doh-rollout.provider-steering.enabled", false);
lockPref("doh-rollout.provider-steering.provider-list", "");
lockPref("doh-rollout.self-enabled", false);
lockPref("doh-rollout.skipHeuristicsCheck", true);
lockPref("doh-rollout.trr-selection.enabled", false);
lockPref("doh-rollout.trr-selection.provider-list", "");
lockPref("doh-rollout.uri", "");
lockPref("network.android_doh.autoselect_enabled", false);

// Disable DoH performance measurements
lockPref("doh-rollout.trrRace.canonicalDomain", "");
lockPref("doh-rollout.trrRace.complete", true);
lockPref("doh-rollout.trrRace.enabled", false);
lockPref("doh-rollout.trrRace.popularDomains", "");
lockPref("doh-rollout.trrRace.randomSubdomainCount", 0);

// Disable 'Essential Domains Fallback'
lockPref("network.essential_domains_fallback", false);

// Disable Fakespot
lockPref("toolkit.shopping.ohttpConfigURL", "");
lockPref("toolkit.shopping.ohttpRelayURL", "");

// Disable fetching Firefox Relay's "allowlist" (list of sites known to support Relay)
lockPref("signon.firefoxRelay.allowListRemoteSettingsCollection", "");

// Disable fetching Password Manager rules remotely by default
lockPref("signon.recipes.remoteRecipes.enabled", false);

// Disable Firefox Messaging System targeting information background updates
lockPref("app.update.background.messaging.targeting.snapshot.intervalSec", -1); 

// Disable Firefox Relay by default
lockPref("signon.firefoxRelay.feature", "disabled");

// Disable "Interest-based Content Relevance Ranking and Personalization"
lockPref("toolkit.contentRelevancy.enabled", false);
lockPref("toolkit.contentRelevancy.ingestEnabled", false);
lockPref("toolkit.contentRelevancy.log", false);

// Disable Mozilla nags/promotions
lockPref("browser.promo.cookiebanners.enabled", false);
lockPref("browser.promo.focus.enabled", false);
lockPref("browser.promo.pin.enabled", false);
lockPref("browser.send_to_device_locales", "");
lockPref("browser.vpn_promo.enabled", false);
lockPref("privacy.trackingprotection.allow_list.hasUserInteractedWithETPSettings", true);

// Disable "Privacy-Preserving Attribution"
lockPref("dom.origin-trials.private-attribution.state", 2);
lockPref("dom.private-attribution.submission.enabled", false);

// Disable Remote Permissions
lockPref("permissions.manager.remote.enabled", false);

// Disable Remote Settings 'Preview' Buckets
lockPref("services.settings.preview_enabled", false);  

// Disable the Web Compatibility Reporter
lockPref("extensions.webcompat-reporter.enabled", false);

// Opt out of add-on metadata updates
lockPref("extensions.getAddons.cache.enabled", false);

// Remove special privileges from Mozilla domains
lockPref("browser.tabs.remote.separatePrivilegedMozillaWebContentProcess", false);
lockPref("browser.tabs.remote.separatedMozillaDomains", "");
lockPref("dom.ipc.processCount.privilegedmozilla", 0);
lockPref("extensions.webextensions.restrictedDomains", "");
lockPref("permissions.manager.defaultsUrl", "");
lockPref("svg.context-properties.content.allowed-domains", "");

// Remove tracking parameters from Mozilla URLs + prevent exposing locale & unnecessary information
lockPref("browser.backup.template.fallback-download.aurora", "https://www.mozilla.org/firefox/channel/desktop/#developer");
lockPref("browser.backup.template.fallback-download.beta", "https://www.mozilla.org/firefox/channel/desktop/#beta");
lockPref("browser.backup.template.fallback-download.esr", "https://www.mozilla.org/firefox/enterprise/#download");
lockPref("browser.backup.template.fallback-download.nightly", "https://www.mozilla.org/firefox/channel/desktop/#nightly");
lockPref("browser.backup.template.fallback-download.release", "https://www.mozilla.org/firefox/download/thanks/?s=direct");
lockPref("extensions.abuseReport.amoFormURL", "https://addons.mozilla.org/feedback/addon/%addonID%/");
lockPref("extensions.blocklist.addonItemURL", "https://addons.mozilla.org/blocked-addon/%addonID%/%addonVersion%/");
lockPref("signon.firefoxRelay.learn_more_url", "https://support.mozilla.org/kb/relay-integration#w_frequently-asked-questions");
lockPref("signon.firefoxRelay.manage_url", "https://relay.firefox.com/accounts/profile/");
lockPref("signon.firefoxRelay.privacy_policy_url", "https://www.mozilla.org/privacy/subscription-services/");
lockPref("signon.firefoxRelay.terms_of_service_url", "https://www.mozilla.org/about/legal/terms/subscription-services/");

// Skip Mozilla's `Privacy Notice` and `Terms of Use`
lockPref("datareporting.policy.dataSubmissionPolicyAcceptedVersion", 999);
lockPref("datareporting.policy.dataSubmissionPolicyNotifiedTime", "32503679999000");
lockPref("termsofuse.acceptedDate", "32503679999000");
lockPref("termsofuse.acceptedVersion", 999);
lockPref("termsofuse.bypassNotification", true);

/* -----------------------------------------------------------------------------------
   003 TRACKING PROTECTION
   ----------------------------------------------------------------------------------- */

// Disable exceptions for minor issues by default
lockPref("privacy.trackingprotection.allow_list.convenience.enabled", false);

// Enable ETP Strict
lockPref("browser.contentblocking.category", "strict"); 

// Block known consent managers (CMPs)
lockPref("privacy.trackingprotection.consentmanager.annotate_channels", true);
lockPref("privacy.trackingprotection.consentmanager.skip.enabled", false);
lockPref("privacy.trackingprotection.consentmanager.skip.pbmode.enabled", false);

// Block known cryptominers
lockPref("privacy.trackingprotection.cryptomining.enabled", true);

// Block known email trackers
lockPref("privacy.trackingprotection.emailtracking.enabled", true);
lockPref("privacy.trackingprotection.emailtracking.pbmode.enabled", true);

// Block known fingerprinters
lockPref("privacy.trackingprotection.antifraud.annotate_channels", true);
lockPref("privacy.trackingprotection.antifraud.skip.enabled", false);
lockPref("privacy.trackingprotection.antifraud.skip.pbmode.enabled", false);
lockPref("privacy.trackingprotection.fingerprinting.enabled", true);

// Block known social trackers
lockPref("privacy.trackingprotection.socialtracking.enabled", true);

// Block known trackers
lockPref("privacy.trackingprotection.annotate_channels", true);
lockPref("privacy.trackingprotection.enabled", true);
lockPref("privacy.trackingprotection.pbmode.enabled", true);

// Block known trackers using the `strict` (Level 2) list
lockPref("privacy.annotate_channels.strict_list.enabled", true);
lockPref("privacy.annotate_channels.strict_list.pbmode.enabled", true);

// Block known tracking cookies
lockPref("network.cookie.cookieBehavior.trackerCookieBlocking", true);
lockPref("privacy.socialtracking.block_cookies.enabled", true);

// Enable Bounce Tracking Protection
lockPref("privacy.bounceTrackingProtection.mode", 1);
lockPref("privacy.bounceTrackingProtection.requireStatefulBounces", false);

// Enable Query Parameter Stripping
lockPref("privacy.query_stripping.enabled", true);
lockPref("privacy.query_stripping.enabled.pbmode", true);
lockPref("privacy.query_stripping.redirect", true);

// Enable SmartBlock & UA overrides/injections
lockPref("extensions.webcompat.enable_shims", true);
lockPref("extensions.webcompat.perform_injections", true);
lockPref("extensions.webcompat.perform_ua_overrides", true);
lockPref("extensions.webcompat.smartblockEmbeds.enabled", true);

// Enable State Partitioning
lockPref("network.fetch.cache_partition_cross_origin", true);
lockPref("privacy.partition.always_partition_third_party_non_cookie_storage", true);
lockPref("privacy.partition.always_partition_third_party_non_cookie_storage.exempt_sessionstorage", false);
lockPref("privacy.partition.bloburl_per_partition_key", true);
lockPref("privacy.partition.network_state", true);
lockPref("privacy.partition.network_state.ocsp_cache", true);
lockPref("privacy.partition.network_state.ocsp_cache.pbmode", true);
lockPref("privacy.partition.serviceWorkers", true);

// Enable Suspected Fingerprinters Protection (FPP)
lockPref("privacy.fingerprintingProtection", true);
lockPref("privacy.fingerprintingProtection.pbmode", true);
lockPref("privacy.reduceTimerPrecision", true);

// Enable TCP/dFPI
lockPref("network.cookie.cookieBehavior", 5);
lockPref("network.cookie.cookieBehavior.optInPartitioning", true);
lockPref("network.cookie.cookieBehavior.optInPartitioning.pbmode", true);
lockPref("network.cookie.cookieBehavior.pbmode", 5);

// Ignore less restricted referer policies (than the default)
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.pbmode", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.pbmode.top_navigation", true);
lockPref("network.http.referer.disallowCrossSiteRelaxingDefault.top_navigation", true);

// Exceptions required to avoid major breakage by default
lockPref("privacy.trackingprotection.allow_list.baseline.enabled", false);
lockPref("privacy.trackingprotection.allow_list.hasMigratedCategoryPrefs", false);

// Lower the network priority of known trackers (if not blocked for whatever reason...)
lockPref("privacy.trackingprotection.lower_network_priority", true);

/* -----------------------------------------------------------------------------------
   004 FINGERPRINTING PROTECTION
   ----------------------------------------------------------------------------------- */

// Disable the ability to switch locales without requiring a restart
lockPref("intl.multilingual.liveReload", false);
lockPref("intl.multilingual.liveReloadBidirectional", false);

// Disable failIfMajorPerformanceCaveat in WebGL contexts
lockPref("webgl.disable-fail-if-major-performance-caveat", true);

// Disable VP9 Benchmark
lockPref("media.benchmark.vp9.threshold", 0);

// Do not use the theme's toolbar color scheme for in-content pages by default
lockPref("browser.theme.unified-color-scheme", false);

// Enable canvas randomization for the browser chrome
lockPref("privacy.resistFingerprinting.randomization.canvas.disable_for_chrome", false);

// Enable fdlibm for Math.sin, Math.cos, and Math.tan
lockPref("javascript.options.use_fdlibm_for_sin_cos_tan", true);

// If FPP/RFP is disabled, limit font visibility to base system fonts + fonts from
lockPref("layout.css.font-visibility", 2);

// Prevent enumeration of media devices
lockPref("media.devices.enumerate.legacy.enabled", false);

// Prevent exposing WebGL Renderer Info
lockPref("webgl.enable-renderer-query", false);
lockPref("webgl.override-unmasked-renderer", "Mozilla");
lockPref("webgl.override-unmasked-vendor", "Mozilla");
lockPref("webgl.sanitize-unmasked-renderer", false);

// Prevent pre-allocating content processes
lockPref("dom.ipc.processPrelaunch.enabled", false);
lockPref("dom.ipc.processPrelaunch.fission.number", 0);

// Prevent using system accent colors
lockPref("widget.non-native-theme.use-theme-accent", false);

// Prevent using system colors
lockPref("browser.display.use_system_colors", false);
lockPref("ui.use_standins_for_native_colors", true);

// Prompt to spoof locale to en-US
lockPref("privacy.spoof_english", 0);

// Reset the fingerprinting randomization key daily (in addition to per-session/when the browser restarts)
lockPref("privacy.resistFingerprinting.randomization.daily_reset.enabled", true);
lockPref("privacy.resistFingerprinting.randomization.daily_reset.private.enabled", true);

// Round window sizes
lockPref("browser.startup.blankWindow", false);
lockPref("privacy.window.maxInnerHeight", 900);
lockPref("privacy.window.maxInnerWidth", 1600);

// Set a fixed temporary storage limit
lockPref("dom.quotaManager.temporaryStorage.fixedLimit", 52428800);

// Set target video resolution to 1080p
lockPref("privacy.resistFingerprinting.target_video_res", 1080);

// Set zoom levels on a per-site basis
lockPref("browser.zoom.siteSpecific", true);

/* -----------------------------------------------------------------------------------
   005 DISK AVOIDANCE
   ----------------------------------------------------------------------------------- */

// Allow permission manager to write to disk
lockPref("permissions.memory_only", false); 

// Allow users to automatically delete files downloaded in Private Browsing
lockPref("browser.download.enableDeletePrivate", true);

// Disable back/forward cache (bfcache)
lockPref("browser.sessionhistory.max_total_viewers", 0);
lockPref("fission.bfcacheInParent", false);

// Disable collection/generation of background thumbnails
lockPref("browser.pagethumbnails.capturing_disabled", true);

// Disable collection/generation of wireframes
lockPref("browser.history.collectWireframes", false);

// Disable coloring visited links
lockPref("layout.css.visited_links_enabled", false);

// Disable disk cache
lockPref("browser.cache.disk.enable", false);
lockPref("browser.cache.disk_cache_ssl", true);

// Disable favicons in shortcuts 
lockPref("browser.shell.shortcutFavicons", false); 

lockPref("browser.contentblocking.database.enabled", false);

// Disable Search & Form History
lockPref("browser.formfill.enable", false);

// Disable WebRTC history
lockPref("media.aboutwebrtc.hist.enabled", false);

// Disable window state restoration
lockPref("browser.restoreWindowState.disabled", true);

// Increase the interval between between Session Store save operations
lockPref("browser.sessionstore.interval", 600000); // 10 minutes

// Prevent storing unnecessary extra session data
lockPref("browser.sessionstore.privacy_level", 2);

// Prevent writing media cache (ex. for video streaming) to disk in private windows
lockPref("browser.privatebrowsing.forceMediaMemoryCache", true);

// Remove cached files from browser windows opened with external applications
lockPref("browser.download.start_downloads_in_tmp_dir", true);
lockPref("browser.helperApps.deleteTempFileOnExit", true);

/* -----------------------------------------------------------------------------------
   006 DOWNLOADS
   ----------------------------------------------------------------------------------- */

// Block insecure downloads
lockPref("dom.block_download_insecure", true);

// Disable extra download logging by default
lockPref("browser.download.loglevel", "Error");

// Notify when downloading files
lockPref("browser.download.alwaysOpenPanel", true);

// Prevent adding downloads to "recent documents"...
lockPref("browser.download.manager.addToRecentDocs", false);

// Prompt before downloading files
lockPref("browser.download.always_ask_before_handling_new_types", true);
lockPref("browser.download.useDownloadDir", false);

/* -----------------------------------------------------------------------------------
   007 HTTP(S)
   ----------------------------------------------------------------------------------- */

// Allow users to bypass invalid certificate errors by default
lockPref("security.certerror.hideAddException", false); 

// Always preload intermediates
lockPref("security.remote_settings.intermediates.enabled", true);

// Always warn on insecure webpages
lockPref("security.insecure_connection_text.enabled", true);
lockPref("security.insecure_connection_text.pbmode.enabled", true);
lockPref("security.ssl.treat_unsafe_negotiation_as_broken", true);

// Always warn when submitting a form from HTTP to HTTPS, even on local IP addresses
lockPref("security.insecure_field_warning.ignore_local_ip_address", false);
lockPref("security.warn_submit_secure_to_insecure", true);

// Disable the automatic import of OS client authentication certificates
lockPref("security.osclientcerts.autoload", false);

// Disable downgrades to insecure TLS 1.0/1.1
lockPref("security.tls.insecure_fallback_hosts", "");
lockPref("security.tls.version.enable-deprecated", false);

// Disable insecure ciphers (Like Chromium & Tor Browser)
lockPref("security.ssl3.dhe_rsa_aes_128_sha", false);
lockPref("security.ssl3.dhe_rsa_aes_256_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_128_sha", false);
lockPref("security.ssl3.ecdhe_ecdsa_aes_256_sha", false);

// Disable Parental Controls
lockPref("network.parental_controls_cached_state", false);

// Disable sending background HTTP requests to websites that do not respond quickly to check if they support HTTPS
lockPref("dom.security.https_only_mode_send_http_background_request", false);

// Disable third-party/OS-level root certificates
lockPref("security.certerrors.mitm.auto_enable_enterprise_roots", false); 
lockPref("security.enterprise_roots.enabled", false);

// Ensure HTTP/3 isn't disabled when/if third-party/OS-level root certificates are found
lockPref("network.http.http3.disable_when_third_party_roots_found", false);

// Disable TLS 1.3 0-RTT
lockPref("network.http.http3.enable_0rtt", false);
lockPref("security.tls.enable_0rtt_data", false);

// Enable (+ enforce) Certificate Transparency
lockPref("security.pki.certificate_transparency.disable_for_hosts", "");
lockPref("security.pki.certificate_transparency.disable_for_spki_hashes", "");
lockPref("security.pki.certificate_transparency.mode", 2);

// Enable CRLite revocation checks & prioritize over OCSP
lockPref("security.pki.crlite_mode", 2);
lockPref("security.remote_settings.crlite_filters.enabled", true);

// Enable Delegated Credentials
lockPref("security.tls.enable_delegated_credentials", true);

// Enable MITM Detection
lockPref("security.certerrors.mitm.priming.enabled", true);
lockPref("security.certerrors.mitm.priming.endpoint", "https://mitmdetection.services.mozilla.com/");

// Enable OCSP stapling
lockPref("security.ssl.enable_ocsp_must_staple", true);
lockPref("security.ssl.enable_ocsp_stapling", true);

// Enable Post Quantum Key Agreement (Kyber)
lockPref("media.webrtc.enable_pq_dtls", true);
lockPref("network.http.http3.enable_kyber", true);
lockPref("security.tls.client_hello.send_p256_keyshare", true);
lockPref("security.tls.enable_kyber", true);

// Enable prompts for unsafe HTTP redirects
lockPref("network.http.prompt-temp-redirect", true);

// Enforce Strict Certificate Pinning
lockPref("security.cert_pinning.enforcement_level", 2);

// Enforce TLS 1.3 downgrade protection
lockPref("security.tls.hello_downgrade_check", true);

// Enforce using HTTPS as much as possible
lockPref("dom.securecontext.allowlist", "");
lockPref("dom.security.https_first", true);
lockPref("dom.security.https_first_for_custom_ports", true);
lockPref("dom.security.https_first_for_local_addresses", true);
lockPref("dom.security.https_first_for_unknown_suffixes", true);
lockPref("dom.security.https_first_pbm", true);
lockPref("dom.security.https_first_schemeless", true);
lockPref("dom.security.https_only_mode", true);
lockPref("dom.security.https_only_mode.upgrade_local", true);
lockPref("dom.security.https_only_mode_pbm", true);
lockPref("security.mixed_content.block_active_content", true);
lockPref("security.mixed_content.block_display_content", false);
lockPref("security.mixed_content.block_object_subrequest", true);
lockPref("security.mixed_content.upgrade_display_content", true);
lockPref("security.mixed_content.upgrade_display_content.audio", true);
lockPref("security.mixed_content.upgrade_display_content.image", true);
lockPref("security.mixed_content.upgrade_display_content.video", true);

// Ensure we use the HSTS preload list
lockPref("network.stricttransportsecurity.preloadlist", true);

// If HTTPS-Only Mode is disabled in favor of HTTPS-First, prevent automatically exempting domains (to ensure we always try HTTPS first...)
lockPref("dom.security.https_first_add_exception_on_failure", false);

// Only allow certificate error exceptions per-session
lockPref("security.certerrors.permanentOverride", false);

// Only load secure websockets from HTTPS pages
lockPref("network.websocket.allowInsecureFromHTTPS", false);

// Require safe renegotiations
lockPref("security.ssl.require_safe_negotiation", true);

// Show detailed information on insecure warning pages
lockPref("browser.xul.error_pages.expert_bad_cert", true);

// Show suggestions when an HTTPS page can not be found 
lockPref("dom.security.https_only_mode_error_page_user_suggestions", true);

/* -----------------------------------------------------------------------------------
   008 IMPLICIT CONNECTIONS
   ----------------------------------------------------------------------------------- */

// Disable Early Hints (Like Cromite)
lockPref("network.early-hints.enabled", false);
lockPref("network.early-hints.over-http-v1-1.enabled", false);
lockPref("network.early-hints.preconnect.enabled", false);
lockPref("network.early-hints.preconnect.max_connections", 0);

// Disable Network Prefetching
lockPref("dom.prefetch_dns_for_anchor_http_document", false);
lockPref("dom.prefetch_dns_for_anchor_https_document", false);
lockPref("network.dns.disablePrefetch", true);
lockPref("network.dns.disablePrefetchFromHTTPS", true);
lockPref("network.dns.prefetch_via_proxy", false);
lockPref("network.http.speculative-parallel-limit", 0);
lockPref("network.predictor.enable-hover-on-ssl", false);
lockPref("network.predictor.enable-prefetch", false);
lockPref("network.predictor.enabled", false);
lockPref("network.prefetch-next", false);

// Disable Preconnect
lockPref("network.preconnect", false);

// Prevent middle mouse clicks from pasting clipboard contents by default
lockPref("middlemouse.paste", false);

// Prevent middle mouse clicks on new tab button opening URLs or searches from clipboard
lockPref("browser.tabs.searchclipboardfor.middleclick", false);
lockPref("middlemouse.contentLoadURL", false);

/* -----------------------------------------------------------------------------------
   009 SEARCH & URL BAR
   ----------------------------------------------------------------------------------- */

// Hide using a different search engine in normal vs. private Windows
lockPref("browser.search.separatePrivateDefault.ui.enabled", false);

// Always show Punycode
lockPref("network.IDN_show_punycode", true);

// Disable search suggestions by default
lockPref("browser.search.suggest.enabled", false);
lockPref("browser.search.suggest.enabled.private", false);

// Use the same search engine in normal and private browsing windows by default
lockPref("browser.search.separatePrivateDefault", false);

/* -----------------------------------------------------------------------------------
   010 DNS
   ----------------------------------------------------------------------------------- */

// Disable DoH Connectivity Checks
lockPref("network.connectivity-service.DNS_HTTPS.domain", "");
lockPref("network.trr.confirmationNS", "skip");
lockPref("network.trr.skip-check-for-blocked-host", true);

// Disable EDNS Client Subnet (ECS) to prevent leaking general location data to authoritative DNS servers...
lockPref("network.trr.disable-ECS", true);

// Disable falling back to system DNS by default
lockPref("network.trr.retry_on_recoverable_errors", true);
lockPref("network.trr.strict_native_fallback", true);

// Disable nsNotifyAddrListener
lockPref("network.notify.changed", false);
lockPref("network.notify.checkForNRPT", false);
lockPref("network.notify.checkForProxies", false);
lockPref("network.notify.dnsSuffixList", false);
lockPref("network.notify.initial_call", false);
lockPref("network.notify.IPv6", false);
lockPref("network.notify.resolvers", false);

// Enable DNS Rebinding Protection
lockPref("network.trr.allow-rfc1918", false);

// Enable DoH without fallback & Set to Quad9 by default
lockPref("network.trr.default_provider_uri", "https://dns.quad9.net/dns-query");
lockPref("network.trr.mode", 3);

// Enable EncryptedClientHello
lockPref("network.dns.echconfig.enabled", true);
lockPref("network.dns.http3_echconfig.enabled", true);

// Enable native DNS HTTPS Lookups
lockPref("network.dns.native_https_query", true);

// Ensure we clear cache upon changing DoH prefs
lockPref("network.trr.clear-cache-on-pref-change", true);

// Fix IPv6 connectivity when DoH is enabled
lockPref("network.dns.preferIPv6", true);

// Prevent bypassing DoH for /etc/HOSTS entries by default
lockPref("network.trr.exclude-etc-hosts", false);

// Prevent sending headers for DoH requests
lockPref("network.trr.send_accept-language_headers", false);
lockPref("network.trr.send_empty_accept-encoding_headers", true);
lockPref("network.trr.send_user-agent_headers", false);


















// Controllo versione
lockPref("rischio.bird", "OK");
